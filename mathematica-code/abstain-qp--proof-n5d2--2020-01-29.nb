(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     47071,       1361]
NotebookOptionsPosition[     44919,       1319]
NotebookOutlinePosition[     45253,       1334]
CellTagsIndexPosition[     45210,       1331]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ell", "=", 
   RowBox[{"n", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}], "/", "2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"v", ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "d"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"X", "=", 
    RowBox[{"Array", "[", 
     RowBox[{"x", ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", "ell"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"MyIndex", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"i", "-", "1"}], ")"}], "n"}], "-", 
      RowBox[{"i", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "-", "1"}], ")"}], "/", "2"}]}], "+", 
      RowBox[{"(", 
       RowBox[{"j", "-", "i"}], ")"}]}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MyIndex", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"j", "-", "1"}], ")"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"j", "-", "2"}], ")"}], "/", "2"}]}], "+", "i"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"MyIndex", "[", 
      RowBox[{"i", ",", "j"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"i", "+", "1"}], ",", "n"}], "}"}]}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"m", ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "ell"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"m", "[", 
      RowBox[{"i", ",", 
       RowBox[{"MyIndex", "[", 
        RowBox[{"i", ",", "j"}], "]"}]}], "]"}], "=", 
     RowBox[{"-", "1"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", 
      RowBox[{"i", "+", "1"}], ",", "n"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"m", "[", 
       RowBox[{"j", ",", 
        RowBox[{"MyIndex", "[", 
         RowBox[{"i", ",", "j"}], "]"}]}], "]"}], "=", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"i", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"equalities", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"m", "[", 
          RowBox[{"i", ",", 
           RowBox[{"MyIndex", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}], "]"}], "\[Equal]", 
         RowBox[{"-", "1"}]}], "&&", 
        RowBox[{
         RowBox[{"m", "[", 
          RowBox[{"j", ",", 
           RowBox[{"MyIndex", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}], "]"}], "\[Equal]", "1"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"i", "+", "1"}], ",", "n"}], "}"}]}], "]"}], "]"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "M", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"https", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
        "questions"}], "/", "40194"}], "/", "how"}], "-", "to", "-", "test", 
     "-", "whether", "-", "an", "-", "expression", "-", "is", "-", "a", "-", 
     "valid", "-", "variable"}]}], "*)"}], 
  RowBox[{
   RowBox[{"variableQ", "=", 
    RowBox[{
     RowBox[{"Quiet", "@", 
      RowBox[{"ListQ", "@", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "#"}], "]"}]}]}], "&"}]}], ";"}]}], "\n", 
 RowBox[{
  RowBox[{"MVars", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "M", "]"}], ",", "variableQ"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"inequalities", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Fold", "[", 
    RowBox[{"And", ",", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "\[LessEqual]", 
         RowBox[{"m", "[", 
          RowBox[{"y", ",", 
           RowBox[{"MyIndex", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}], "]"}], "\[LessEqual]", "1"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "n"}], "}"}]}], "]"}], "]"}]}], "]"}],
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"i", ",", "j"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"n", "-", "d"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "d"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", "=", 
   RowBox[{"M", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "d"}], ",", "All"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{"M", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{
       RowBox[{"d", "+", "1"}], ";;", "n"}], ",", "All"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"derivedinequalities", "=", 
  RowBox[{"Fold", "[", 
   RowBox[{"And", ",", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"i", ",", "j"}], "]"}], "\[LessEqual]", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"n", "-", "d"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "d"}], "}"}]}], "]"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdyVsog2EAxvFvLGSTtmjSpkizKUtTLIf4RhZqZpSFVmOarWwlK6WtNtnh
apQLWlEuJOaCVhZzKIemVlOjUeROE7mYC4da+Z734ulXz79y3KadzKEoSsQM
dvnmjKbmD1r5LHfAaqvUB4M8tR/GOJIA1Ls8RLXRfQzPhibPSU8exKGlMHEP
bxu39qcYuZrWa0h1CfrMjMKgmNh2SA9DQc8oMZprnYe7tNwJ2SeBBWh5fCGe
ejt9cGbaRHTa0ytQI84QtxtUT/BI30+MZv4ykJ/v/IJxqfYHhiRXWZg2+lkW
RtF6hviWrSuCdEpTDEODsRI48G0WwCWPTAithnairjvWBOWmegVU6N8jEy0f
dIcnfQzHsrUJqEtWPcBU4teyyOhQ8+xQ9frtgp/8NTfc2CsNexnzUqwI7A3z
o3CTuruAI4buG8jm2Iju2YoCH/7LGuLqsrIM7si45fAfH0DXtQ==
  "],
 CellLabel->
  "In[272]:=",ExpressionUUID->"ef8846d7-f2a0-4da3-8189-825fade4ede7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"m", "[", 
       RowBox[{"1", ",", "3"}], "]"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"m", "[", 
       RowBox[{"1", ",", "5"}], "]"}], 
      RowBox[{"m", "[", 
       RowBox[{"1", ",", "6"}], "]"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"m", "[", 
       RowBox[{"1", ",", "8"}], "]"}], 
      RowBox[{"m", "[", 
       RowBox[{"1", ",", "9"}], "]"}], 
      RowBox[{"m", "[", 
       RowBox[{"1", ",", "10"}], "]"}]},
     {"1", 
      RowBox[{"m", "[", 
       RowBox[{"2", ",", "2"}], "]"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"m", "[", 
       RowBox[{"2", ",", "4"}], "]"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"m", "[", 
       RowBox[{"2", ",", "6"}], "]"}], 
      RowBox[{"m", "[", 
       RowBox[{"2", ",", "7"}], "]"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"m", "[", 
       RowBox[{"2", ",", "9"}], "]"}], 
      RowBox[{"m", "[", 
       RowBox[{"2", ",", "10"}], "]"}]},
     {
      RowBox[{"m", "[", 
       RowBox[{"3", ",", "1"}], "]"}], "1", "1", 
      RowBox[{"m", "[", 
       RowBox[{"3", ",", "4"}], "]"}], 
      RowBox[{"m", "[", 
       RowBox[{"3", ",", "5"}], "]"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"m", "[", 
       RowBox[{"3", ",", "7"}], "]"}], 
      RowBox[{"m", "[", 
       RowBox[{"3", ",", "8"}], "]"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"m", "[", 
       RowBox[{"3", ",", "10"}], "]"}]},
     {
      RowBox[{"m", "[", 
       RowBox[{"4", ",", "1"}], "]"}], 
      RowBox[{"m", "[", 
       RowBox[{"4", ",", "2"}], "]"}], 
      RowBox[{"m", "[", 
       RowBox[{"4", ",", "3"}], "]"}], "1", "1", "1", 
      RowBox[{"m", "[", 
       RowBox[{"4", ",", "7"}], "]"}], 
      RowBox[{"m", "[", 
       RowBox[{"4", ",", "8"}], "]"}], 
      RowBox[{"m", "[", 
       RowBox[{"4", ",", "9"}], "]"}], 
      RowBox[{"-", "1"}]},
     {
      RowBox[{"m", "[", 
       RowBox[{"5", ",", "1"}], "]"}], 
      RowBox[{"m", "[", 
       RowBox[{"5", ",", "2"}], "]"}], 
      RowBox[{"m", "[", 
       RowBox[{"5", ",", "3"}], "]"}], 
      RowBox[{"m", "[", 
       RowBox[{"5", ",", "4"}], "]"}], 
      RowBox[{"m", "[", 
       RowBox[{"5", ",", "5"}], "]"}], 
      RowBox[{"m", "[", 
       RowBox[{"5", ",", "6"}], "]"}], "1", "1", "1", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7887195735756187`*^9, {3.788719624430552*^9, 3.788719639924255*^9}, 
   3.7887197567464952`*^9, 3.78872073136701*^9, 3.788720827428051*^9, {
   3.7887211184926643`*^9, 3.788721125438794*^9}, 3.788721183529571*^9, 
   3.788721220722692*^9, 3.788721320107705*^9, 3.788721890943068*^9, 
   3.788722193159279*^9, {3.7887222909016733`*^9, 3.788722299177115*^9}, {
   3.788722343626589*^9, 3.788722365244429*^9}, 3.788722403376511*^9, 
   3.7887254825833282`*^9, 3.78922887957821*^9, 3.789233649239066*^9, 
   3.789233861898096*^9, {3.789302616963027*^9, 3.789302629040007*^9}, 
   3.7893026601332397`*^9, 3.789302697674357*^9, 3.789302806227585*^9, 
   3.789307329398892*^9, 3.78930736807656*^9, 3.789307423720105*^9, 
   3.789307468006679*^9, 3.78930796998417*^9, {3.789308099668433*^9, 
   3.78930811287192*^9}},
 CellLabel->
  "Out[282]//MatrixForm=",ExpressionUUID->"1c092212-2cb8-498a-a270-\
318cbfe2eba0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"1", ",", "3"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"1", ",", "5"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"1", ",", "8"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"1", ",", "6"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"1", ",", "9"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"1", ",", "10"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"2", ",", "4"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"2", ",", "7"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"2", ",", "6"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"2", ",", "9"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"2", ",", "10"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"3", ",", "1"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"3", ",", "4"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"3", ",", "7"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"3", ",", "5"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"3", ",", "8"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"3", ",", "10"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"4", ",", "1"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"4", ",", "2"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"4", ",", "7"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"4", ",", "3"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"4", ",", "8"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"4", ",", "9"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"5", ",", "1"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"5", ",", "2"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"5", ",", "4"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"5", ",", "3"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"5", ",", "5"}], "]"}], "\[LessEqual]", "1"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "\[LessEqual]", 
   RowBox[{"m", "[", 
    RowBox[{"5", ",", "6"}], "]"}], "\[LessEqual]", "1"}]}]], "Output",
 CellChangeTimes->{
  3.7887195735756187`*^9, {3.788719624430552*^9, 3.788719639924255*^9}, 
   3.7887197567464952`*^9, 3.78872073136701*^9, 3.788720827428051*^9, {
   3.7887211184926643`*^9, 3.788721125438794*^9}, 3.788721183529571*^9, 
   3.788721220722692*^9, 3.788721320107705*^9, 3.788721890943068*^9, 
   3.788722193159279*^9, {3.7887222909016733`*^9, 3.788722299177115*^9}, {
   3.788722343626589*^9, 3.788722365244429*^9}, 3.788722403376511*^9, 
   3.7887254825833282`*^9, 3.78922887957821*^9, 3.789233649239066*^9, 
   3.789233861898096*^9, {3.789302616963027*^9, 3.789302629040007*^9}, 
   3.7893026601332397`*^9, 3.789302697674357*^9, 3.789302806227585*^9, 
   3.789307329398892*^9, 3.78930736807656*^9, 3.789307423720105*^9, 
   3.789307468006679*^9, 3.78930796998417*^9, {3.789308099668433*^9, 
   3.789308112913706*^9}},
 CellLabel->
  "Out[285]=",ExpressionUUID->"0dcdb26c-eb17-4153-8fcc-ca04632f4071"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"1", ",", "1"}], "]"}], "\[LessEqual]", "0"}], "&&", 
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"1", ",", "2"}], "]"}], "\[LessEqual]", "0"}], "&&", 
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"2", ",", "1"}], "]"}], "\[LessEqual]", "0"}], "&&", 
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "\[LessEqual]", "0"}], "&&", 
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"3", ",", "1"}], "]"}], "\[LessEqual]", "0"}], "&&", 
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"3", ",", "2"}], "]"}], "\[LessEqual]", "0"}]}]], "Output",
 CellChangeTimes->{
  3.7887195735756187`*^9, {3.788719624430552*^9, 3.788719639924255*^9}, 
   3.7887197567464952`*^9, 3.78872073136701*^9, 3.788720827428051*^9, {
   3.7887211184926643`*^9, 3.788721125438794*^9}, 3.788721183529571*^9, 
   3.788721220722692*^9, 3.788721320107705*^9, 3.788721890943068*^9, 
   3.788722193159279*^9, {3.7887222909016733`*^9, 3.788722299177115*^9}, {
   3.788722343626589*^9, 3.788722365244429*^9}, 3.788722403376511*^9, 
   3.7887254825833282`*^9, 3.78922887957821*^9, 3.789233649239066*^9, 
   3.789233861898096*^9, {3.789302616963027*^9, 3.789302629040007*^9}, 
   3.7893026601332397`*^9, 3.789302697674357*^9, 3.789302806227585*^9, 
   3.789307329398892*^9, 3.78930736807656*^9, 3.789307423720105*^9, 
   3.789307468006679*^9, 3.78930796998417*^9, {3.789308099668433*^9, 
   3.789308112916563*^9}},
 CellLabel->
  "Out[289]=",ExpressionUUID->"ce7e0be8-f367-4f19-a709-294b97c85123"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "After", " ", "running", " ", "the", " ", "above", " ", "with", " ", 
     "n"}], "=", 
    RowBox[{
     RowBox[{"4", " ", "d"}], "=", "2"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"knownsolution4", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], "\[Equal]", 
       RowBox[{"-", "1"}]}], "&&", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], "\[Equal]", "0"}], "&&", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], "\[Equal]", "0"}], "&&", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], "\[Equal]", 
       RowBox[{"-", "1"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"A", ".", "Y"}], "\[Equal]", "Z"}], "&&", "inequalities", "&&",
         "derivedinequalities", "&&", "knownsolution4"}], ",", "Reals"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"s1", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "inequalities"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"M", "/.", "s1"}], "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", 
    RowBox[{"M", "/.", "s1"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.788720689377475*^9, 3.788720708673719*^9}, {
  3.789233890569312*^9, 3.789233913751231*^9}, {3.789302788360433*^9, 
  3.789302819095228*^9}, {3.7893074901303*^9, 3.7893076481163282`*^9}, {
  3.78930769458491*^9, 3.789307695504459*^9}, {3.789307732302682*^9, 
  3.78930773528513*^9}, {3.789307833988748*^9, 3.7893078599362288`*^9}, {
  3.789307931218796*^9, 3.789307949694422*^9}},
 CellLabel->
  "In[265]:=",ExpressionUUID->"00ce4b35-0bbc-4e6a-9507-309fb1051563"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"1", ",", "2"}], "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"2", ",", "2"}], "]"}], "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{
    RowBox[{"m", "[", 
     RowBox[{"1", ",", "3"}], "]"}], "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{
    RowBox[{"m", "[", 
     RowBox[{"1", ",", "6"}], "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"m", "[", 
     RowBox[{"2", ",", "4"}], "]"}], "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{
    RowBox[{"m", "[", 
     RowBox[{"2", ",", "6"}], "]"}], "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{
    RowBox[{"m", "[", 
     RowBox[{"3", ",", "1"}], "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"m", "[", 
     RowBox[{"3", ",", "4"}], "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"m", "[", 
     RowBox[{"3", ",", "5"}], "]"}], "\[Rule]", 
    RowBox[{"-", 
     RowBox[{"m", "[", 
      RowBox[{"1", ",", "5"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"m", "[", 
     RowBox[{"4", ",", "1"}], "]"}], "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{
    RowBox[{"m", "[", 
     RowBox[{"4", ",", "2"}], "]"}], "\[Rule]", 
    RowBox[{"-", 
     RowBox[{"m", "[", 
      RowBox[{"2", ",", "2"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"m", "[", 
     RowBox[{"4", ",", "3"}], "]"}], "\[Rule]", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7893075668894653`*^9, 3.7893076110729723`*^9}, 
   3.789307649380138*^9, 3.7893076960078497`*^9, 3.78930774389781*^9, {
   3.789307835575664*^9, 3.7893078606940937`*^9}, 3.78930795146835*^9, {
   3.789308093512356*^9, 3.7893081031848*^9}},
 CellLabel->
  "Out[267]=",ExpressionUUID->"53940711-c50b-4058-94e5-d9255b8d0d16"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"m", "[", 
      RowBox[{"1", ",", "5"}], "]"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"m", "[", 
      RowBox[{"2", ",", "2"}], "]"}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", 
     RowBox[{"-", 
      RowBox[{"m", "[", 
       RowBox[{"1", ",", "5"}], "]"}]}], ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", 
      RowBox[{"m", "[", 
       RowBox[{"2", ",", "2"}], "]"}]}], ",", "1", ",", "1", ",", "1", ",", 
     "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7893075668894653`*^9, 3.7893076110729723`*^9}, 
   3.789307649380138*^9, 3.7893076960078497`*^9, 3.78930774389781*^9, {
   3.789307835575664*^9, 3.7893078606940937`*^9}, 3.78930795146835*^9, {
   3.789308093512356*^9, 3.7893081031869802`*^9}},
 CellLabel->
  "Out[268]=",ExpressionUUID->"317bc2b3-fa09-4106-ac90-0330e3702f5a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"m", "[", 
       RowBox[{"1", ",", "5"}], "]"}], "1"},
     {"1", 
      RowBox[{"m", "[", 
       RowBox[{"2", ",", "2"}], "]"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}]},
     {"1", "1", "1", "1", 
      RowBox[{"-", 
       RowBox[{"m", "[", 
        RowBox[{"1", ",", "5"}], "]"}]}], 
      RowBox[{"-", "1"}]},
     {
      RowBox[{"-", "1"}], 
      RowBox[{"-", 
       RowBox[{"m", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], "1", "1", "1", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7893075668894653`*^9, 3.7893076110729723`*^9}, 
   3.789307649380138*^9, 3.7893076960078497`*^9, 3.78930774389781*^9, {
   3.789307835575664*^9, 3.7893078606940937`*^9}, 3.78930795146835*^9, {
   3.789308093512356*^9, 3.789308103188998*^9}},
 CellLabel->
  "Out[269]//MatrixForm=",ExpressionUUID->"efb51f4d-fa32-4a64-ab91-\
e76da607fa1b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Saving", " ", "the", " ", "n"}], "=", 
    RowBox[{"4", " ", "solution"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"A4", "=", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"-", "1"}], "0"},
         {"0", 
          RowBox[{"-", "1"}]}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M4", "=", 
     TagBox[
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {
           RowBox[{"-", "1"}], 
           RowBox[{"-", "1"}], 
           RowBox[{"-", "1"}], 
           RowBox[{"-", "1"}], "p", "1"},
          {"1", "q", 
           RowBox[{"-", "1"}], 
           RowBox[{"-", "1"}], 
           RowBox[{"-", "1"}], 
           RowBox[{"-", "1"}]},
          {"1", "1", "1", "1", 
           RowBox[{"-", "p"}], 
           RowBox[{"-", "1"}]},
          {
           RowBox[{"-", "1"}], 
           RowBox[{"-", "q"}], "1", "1", "1", "1"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.78930255180728*^9, 3.789302583124612*^9}, {
   3.789302734259482*^9, 3.78930277559066*^9}, 3.7893031271790752`*^9, {
   3.789307873966177*^9, 3.7893079030127907`*^9}, {3.789307954591194*^9, 
   3.789307962006428*^9}},
 CellLabel->
  "In[291]:=",ExpressionUUID->"ffffffff-ffff-4fff-bfff-ffffffffffff"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Now", " ", "having", " ", "run", " ", "the", " ", "first", " ", "block", 
     " ", "with", " ", "n"}], "=", "5"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"subproblem", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "\[LessEqual]", "p", "\[LessEqual]", "1"}], "&&", 
      RowBox[{
       RowBox[{"-", "1"}], "\[LessEqual]", "q", "\[LessEqual]", "1"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"m", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "=", 
       RowBox[{"M4", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "6"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "=", 
       RowBox[{"A4", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "2"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"MatrixForm", "[", "M", "]"}], ",", 
     RowBox[{"MatrixForm", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"MatrixForm", "[", "Y", "]"}], ",", 
        RowBox[{"MatrixForm", "[", "Z", "]"}]}], "}"}], "]"}]}], "}"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "A", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.78930285717314*^9, 3.789302907388467*^9}, {
  3.7893029456295033`*^9, 3.789302971560803*^9}, {3.789307978637945*^9, 
  3.789308072243264*^9}, {3.789308124419181*^9, 3.7893082246148033`*^9}, {
  3.789308266756085*^9, 3.789308356082368*^9}, {3.789308391067328*^9, 
  3.7893084040272913`*^9}},
 CellLabel->
  "In[321]:=",ExpressionUUID->"2d9b12b4-692c-4600-b459-8a00069adeee"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"-", "1"}], 
        RowBox[{"-", "1"}], 
        RowBox[{"-", "1"}], 
        RowBox[{"-", "1"}], "p", "1", 
        RowBox[{"-", "1"}], 
        RowBox[{"m", "[", 
         RowBox[{"1", ",", "8"}], "]"}], 
        RowBox[{"m", "[", 
         RowBox[{"1", ",", "9"}], "]"}], 
        RowBox[{"m", "[", 
         RowBox[{"1", ",", "10"}], "]"}]},
       {"1", "q", 
        RowBox[{"-", "1"}], 
        RowBox[{"-", "1"}], 
        RowBox[{"-", "1"}], 
        RowBox[{"-", "1"}], 
        RowBox[{"m", "[", 
         RowBox[{"2", ",", "7"}], "]"}], 
        RowBox[{"-", "1"}], 
        RowBox[{"m", "[", 
         RowBox[{"2", ",", "9"}], "]"}], 
        RowBox[{"m", "[", 
         RowBox[{"2", ",", "10"}], "]"}]},
       {"1", "1", "1", "1", 
        RowBox[{"-", "p"}], 
        RowBox[{"-", "1"}], 
        RowBox[{"m", "[", 
         RowBox[{"3", ",", "7"}], "]"}], 
        RowBox[{"m", "[", 
         RowBox[{"3", ",", "8"}], "]"}], 
        RowBox[{"-", "1"}], 
        RowBox[{"m", "[", 
         RowBox[{"3", ",", "10"}], "]"}]},
       {
        RowBox[{"-", "1"}], 
        RowBox[{"-", "q"}], "1", "1", "1", "1", 
        RowBox[{"m", "[", 
         RowBox[{"4", ",", "7"}], "]"}], 
        RowBox[{"m", "[", 
         RowBox[{"4", ",", "8"}], "]"}], 
        RowBox[{"m", "[", 
         RowBox[{"4", ",", "9"}], "]"}], 
        RowBox[{"-", "1"}]},
       {
        RowBox[{"m", "[", 
         RowBox[{"5", ",", "1"}], "]"}], 
        RowBox[{"m", "[", 
         RowBox[{"5", ",", "2"}], "]"}], 
        RowBox[{"m", "[", 
         RowBox[{"5", ",", "3"}], "]"}], 
        RowBox[{"m", "[", 
         RowBox[{"5", ",", "4"}], "]"}], 
        RowBox[{"m", "[", 
         RowBox[{"5", ",", "5"}], "]"}], 
        RowBox[{"m", "[", 
         RowBox[{"5", ",", "6"}], "]"}], "1", "1", "1", "1"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {
              RowBox[{"-", "1"}], 
              RowBox[{"-", "1"}], 
              RowBox[{"-", "1"}], 
              RowBox[{"-", "1"}], "p", "1", 
              RowBox[{"-", "1"}], 
              RowBox[{"m", "[", 
               RowBox[{"1", ",", "8"}], "]"}], 
              RowBox[{"m", "[", 
               RowBox[{"1", ",", "9"}], "]"}], 
              RowBox[{"m", "[", 
               RowBox[{"1", ",", "10"}], "]"}]},
             {"1", "q", 
              RowBox[{"-", "1"}], 
              RowBox[{"-", "1"}], 
              RowBox[{"-", "1"}], 
              RowBox[{"-", "1"}], 
              RowBox[{"m", "[", 
               RowBox[{"2", ",", "7"}], "]"}], 
              RowBox[{"-", "1"}], 
              RowBox[{"m", "[", 
               RowBox[{"2", ",", "9"}], "]"}], 
              RowBox[{"m", "[", 
               RowBox[{"2", ",", "10"}], "]"}]}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]},
        {
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"1", "1", "1", "1", 
              RowBox[{"-", "p"}], 
              RowBox[{"-", "1"}], 
              RowBox[{"m", "[", 
               RowBox[{"3", ",", "7"}], "]"}], 
              RowBox[{"m", "[", 
               RowBox[{"3", ",", "8"}], "]"}], 
              RowBox[{"-", "1"}], 
              RowBox[{"m", "[", 
               RowBox[{"3", ",", "10"}], "]"}]},
             {
              RowBox[{"-", "1"}], 
              RowBox[{"-", "q"}], "1", "1", "1", "1", 
              RowBox[{"m", "[", 
               RowBox[{"4", ",", "7"}], "]"}], 
              RowBox[{"m", "[", 
               RowBox[{"4", ",", "8"}], "]"}], 
              RowBox[{"m", "[", 
               RowBox[{"4", ",", "9"}], "]"}], 
              RowBox[{"-", "1"}]},
             {
              RowBox[{"m", "[", 
               RowBox[{"5", ",", "1"}], "]"}], 
              RowBox[{"m", "[", 
               RowBox[{"5", ",", "2"}], "]"}], 
              RowBox[{"m", "[", 
               RowBox[{"5", ",", "3"}], "]"}], 
              RowBox[{"m", "[", 
               RowBox[{"5", ",", "4"}], "]"}], 
              RowBox[{"m", "[", 
               RowBox[{"5", ",", "5"}], "]"}], 
              RowBox[{"m", "[", 
               RowBox[{"5", ",", "6"}], "]"}], "1", "1", "1", "1"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{{3.789302908522146*^9, 3.7893029164850397`*^9}, 
   3.789302972616479*^9, {3.7893081262351522`*^9, 3.789308146932817*^9}, 
   3.789308186432732*^9, 3.789308225643442*^9, 3.789308271206315*^9, {
   3.789308303560976*^9, 3.789308329319236*^9}, 3.789308404689727*^9},
 CellLabel->
  "Out[324]=",ExpressionUUID->"b775ff8c-1aa8-44fb-9188-9c1ad2546531"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1"}], "0"},
     {"0", 
      RowBox[{"-", "1"}]},
     {
      RowBox[{"a", "[", 
       RowBox[{"3", ",", "1"}], "]"}], 
      RowBox[{"a", "[", 
       RowBox[{"3", ",", "2"}], "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.789302908522146*^9, 3.7893029164850397`*^9}, 
   3.789302972616479*^9, {3.7893081262351522`*^9, 3.789308146932817*^9}, 
   3.789308186432732*^9, 3.789308225643442*^9, 3.789308271206315*^9, {
   3.789308303560976*^9, 3.789308329319236*^9}, 3.789308404692917*^9},
 CellLabel->
  "Out[325]//MatrixForm=",ExpressionUUID->"cc10419f-4c2a-49f5-97f6-\
4196189f3148"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Let", "'"}], "s", " ", "just", " ", "fill", " ", "in", " ", 
    "the", " ", "rest", " ", "of", " ", "the", " ", "first", " ", "4", " ", 
    "rows"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"A4", ".", "Y"}], "\[Equal]", 
         RowBox[{"Z", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", "2"}], ",", "All"}], "]"}], "]"}]}], "&&", 
        "inequalities", "&&", "derivedinequalities"}], ",", "Reals"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"s1", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"inequalities", "&&", "derivedinequalities"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M", "/.", "s1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", 
    RowBox[{"M", "/.", "s1"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.788720689377475*^9, 3.788720708673719*^9}, {
  3.789233890569312*^9, 3.789233913751231*^9}, {3.789302788360433*^9, 
  3.789302819095228*^9}, {3.789308436303776*^9, 3.789308479077035*^9}, {
  3.7893085128177433`*^9, 3.789308514337723*^9}, {3.7893085479900084`*^9, 
  3.78930856681778*^9}},
 CellLabel->
  "In[344]:=",ExpressionUUID->"ad1798fb-26e7-4a61-86cc-a9c6727c19d7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "p", "1", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", 
       RowBox[{"m", "[", 
        RowBox[{"3", ",", "8"}], "]"}]}], "1", 
      RowBox[{"-", 
       RowBox[{"m", "[", 
        RowBox[{"3", ",", "10"}], "]"}]}]},
     {"1", "q", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", 
       RowBox[{"m", "[", 
        RowBox[{"4", ",", "7"}], "]"}]}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", 
       RowBox[{"m", "[", 
        RowBox[{"4", ",", "9"}], "]"}]}], "1"},
     {"1", "1", "1", "1", 
      RowBox[{"-", "p"}], 
      RowBox[{"-", "1"}], "1", 
      RowBox[{"m", "[", 
       RowBox[{"3", ",", "8"}], "]"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"m", "[", 
       RowBox[{"3", ",", "10"}], "]"}]},
     {
      RowBox[{"-", "1"}], 
      RowBox[{"-", "q"}], "1", "1", "1", "1", 
      RowBox[{"m", "[", 
       RowBox[{"4", ",", "7"}], "]"}], "1", 
      RowBox[{"m", "[", 
       RowBox[{"4", ",", "9"}], "]"}], 
      RowBox[{"-", "1"}]},
     {
      RowBox[{"m", "[", 
       RowBox[{"5", ",", "1"}], "]"}], 
      RowBox[{"m", "[", 
       RowBox[{"5", ",", "2"}], "]"}], 
      RowBox[{"m", "[", 
       RowBox[{"5", ",", "3"}], "]"}], 
      RowBox[{"m", "[", 
       RowBox[{"5", ",", "4"}], "]"}], 
      RowBox[{"m", "[", 
       RowBox[{"5", ",", "5"}], "]"}], 
      RowBox[{"m", "[", 
       RowBox[{"5", ",", "6"}], "]"}], "1", "1", "1", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.789308250226014*^9, {3.7893084527760773`*^9, 3.789308480070079*^9}, 
   3.7893085151574583`*^9, {3.789308549969445*^9, 3.789308567289662*^9}},
 CellLabel->
  "Out[347]//MatrixForm=",ExpressionUUID->"23ca4f10-9d83-411a-bf0b-\
80bd86c9232e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Try", " ", "to", " ", "see", " ", "where", " ", "we", " ", "get", " ", 
    "a", " ", "contradiction"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"S", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"A", ".", 
          RowBox[{"Y", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"7", ";;", "10"}]}], "]"}], "]"}]}], "\[Equal]", 
         RowBox[{"Z", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"7", ";;", "10"}]}], "]"}], "]"}]}], "&&", "inequalities",
         "&&", "derivedinequalities"}], ",", "Reals"}], "]"}], ",", 
     RowBox[{"inequalities", "&&", "derivedinequalities"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.789308659014792*^9, 3.789308684042341*^9}, {
  3.789308717271051*^9, 3.789308810414954*^9}, {3.789308844819647*^9, 
  3.7893088682964973`*^9}},
 CellLabel->
  "In[354]:=",ExpressionUUID->"1646ac0b-f48e-4ff3-bf04-1a8da553b317"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.789308785664345*^9, 3.789308812188715*^9}, {
  3.789308863586165*^9, 3.789308874238021*^9}},
 CellLabel->
  "Out[354]=",ExpressionUUID->"64b7d9e3-e0e2-497b-b88d-29ab57558a50"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Aha", ",", " ", 
    RowBox[{
     RowBox[{
     "so", " ", "the", " ", "last", " ", "4", " ", "columns", " ", "are", " ",
       "the", " ", "problem"}], ";", " ", 
     RowBox[{
      RowBox[{"let", "'"}], "s", " ", "check", " ", "by", " ", 
      "\"\<hand\>\""}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Reduce", "[", 
    RowBox[{
     RowBox[{"Exists", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r1", ",", "r2", ",", "r3", ",", "r4"}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", "a"}], "+", 
          RowBox[{"b", " ", "r1"}]}], "\[Equal]", "1"}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"a", " ", "r2"}], "-", "b"}], "\[Equal]", "1"}], " ", "&&", 
        
        RowBox[{
         RowBox[{"a", "+", 
          RowBox[{"b", " ", "r2"}]}], "\[Equal]", "1"}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"a", " ", "r4"}], "+", "b"}], "\[Equal]", "1"}], " ", "&&", 
        
        RowBox[{
         RowBox[{"-", "1"}], "\[LessEqual]", "r1", "\[LessEqual]", "1"}], "&&", 
        RowBox[{
         RowBox[{"-", "1"}], "\[LessEqual]", "r2", "\[LessEqual]", "1"}], "&&", 
        RowBox[{
         RowBox[{"-", "1"}], "\[LessEqual]", "r3", "\[LessEqual]", "1"}], "&&", 
        RowBox[{
         RowBox[{"-", "1"}], "\[LessEqual]", "r4", "\[LessEqual]", "1"}]}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", "Reals"}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.7893089027163353`*^9, 3.7893090770414457`*^9}},
 CellLabel->
  "In[357]:=",ExpressionUUID->"f2c0d8eb-f617-43bc-b3ed-af0bccd370ce"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.789309022609194*^9, 3.789309039735581*^9}, 
   3.789309077835178*^9},
 CellLabel->
  "Out[357]=",ExpressionUUID->"9a3c7969-bb7e-404e-8f81-e78fe6a94209"]
}, Open  ]]
},
WindowSize->{1920, 1100},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 7097, 227, 492, "Input",ExpressionUUID->"ef8846d7-f2a0-4da3-8189-825fade4ede7"],
Cell[7680, 251, 3790, 106, 124, "Output",ExpressionUUID->"1c092212-2cb8-498a-a270-318cbfe2eba0"],
Cell[11473, 359, 5120, 136, 82, "Output",ExpressionUUID->"0dcdb26c-eb17-4153-8fcc-ca04632f4071"],
Cell[16596, 497, 1541, 34, 35, "Output",ExpressionUUID->"ce7e0be8-f367-4f19-a709-294b97c85123"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18174, 536, 1952, 52, 147, "Input",ExpressionUUID->"00ce4b35-0bbc-4e6a-9507-309fb1051563"],
Cell[20129, 590, 2018, 62, 35, "Output",ExpressionUUID->"53940711-c50b-4058-94e5-d9255b8d0d16"],
Cell[22150, 654, 1292, 37, 35, "Output",ExpressionUUID->"317bc2b3-fa09-4106-ac90-0330e3702f5a"],
Cell[23445, 693, 1568, 46, 105, "Output",ExpressionUUID->"efb51f4d-fa32-4a64-ab91-e76da607fa1b"]
}, Open  ]],
Cell[25028, 742, 2374, 67, 150, InheritFromParent,ExpressionUUID->"ffffffff-ffff-4fff-bfff-ffffffffffff"],
Cell[CellGroupData[{
Cell[27427, 813, 2086, 60, 147, "Input",ExpressionUUID->"2d9b12b4-692c-4600-b459-8a00069adeee"],
Cell[29516, 875, 6952, 188, 110, "Output",ExpressionUUID->"b775ff8c-1aa8-44fb-9188-9c1ad2546531"],
Cell[36471, 1065, 1147, 31, 84, "Output",ExpressionUUID->"cc10419f-4c2a-49f5-97f6-4196189f3148"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37655, 1101, 1502, 39, 124, "Input",ExpressionUUID->"ad1798fb-26e7-4a61-86cc-a9c6727c19d7"],
Cell[39160, 1142, 2390, 74, 124, "Output",ExpressionUUID->"23ca4f10-9d83-411a-bf0b-80bd86c9232e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41587, 1221, 1091, 29, 55, "Input",ExpressionUUID->"1646ac0b-f48e-4ff3-bf04-1a8da553b317"],
Cell[42681, 1252, 243, 5, 35, "Output",ExpressionUUID->"64b7d9e3-e0e2-497b-b88d-29ab57558a50"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42961, 1262, 1732, 48, 55, "Input",ExpressionUUID->"f2c0d8eb-f617-43bc-b3ed-af0bccd370ce"],
Cell[44696, 1312, 207, 4, 35, "Output",ExpressionUUID->"9a3c7969-bb7e-404e-8f81-e78fe6a94209"]
}, Open  ]]
}
]
*)

