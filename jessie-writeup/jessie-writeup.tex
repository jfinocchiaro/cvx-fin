\documentclass[12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{mathtools, amsmath, amsthm, amssymb, graphicx, mathrsfs, verbatim}
%\usepackage[thmmarks, thref, amsthm]{ntheorem}
\usepackage{color}
\usepackage{wrapfig}
\usepackage{subcaption}
\usepackage[colorinlistoftodos,textsize=tiny]{todonotes} % need xargs for below
%\usepackage{accents}
\usepackage{bbm}
\usepackage{xspace}
\usepackage[margin=1.25in]{geometry}

\usepackage[colorlinks=true,breaklinks=true,bookmarks=true,urlcolor=blue,
     citecolor=blue,linkcolor=blue,bookmarksopen=false,draft=false]{hyperref}

\newcommand{\Comments}{1}
\newcommand{\mynote}[2]{\ifnum\Comments=1\textcolor{#1}{#2}\fi}
\newcommand{\mytodo}[2]{\ifnum\Comments=1%
  \todo[linecolor=#1!80!black,backgroundcolor=#1,bordercolor=#1!80!black]{#2}\fi}
\newcommand{\raf}[1]{\mynote{green}{[RF: #1]}}
\newcommand{\raft}[1]{\mytodo{green!20!white}{RF: #1}}
\newcommand{\jessie}[1]{\mynote{purple}{[JF: #1]}}
\newcommand{\jessiet}[1]{\mytodo{purple!20!white}{JF: #1}}
\ifnum\Comments=1               % fix margins for todonotes
  \setlength{\marginparwidth}{1in}
\fi


\newcommand{\reals}{\mathbb{R}}
\newcommand{\posreals}{\reals_{>0}}%{\reals_{++}}

% alphabetical order, by convention
\newcommand{\D}{\mathcal{D}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\F}{\mathcal{F}}
\newcommand{\I}{\mathcal{I}}
\renewcommand{\P}{\mathcal{P}}
\newcommand{\R}{\mathcal{R}}
\newcommand{\X}{\mathcal{X}}
\newcommand{\Y}{\mathcal{Y}}


\newcommand{\inter}[1]{\mathring{#1}}%\mathrm{int}(#1)}
\newcommand{\cl}[1]{\text{cl}(#1)}
%\newcommand{\expectedv}[3]{\overline{#1}(#2,#3)}
\newcommand{\expectedv}[3]{\E_{Y\sim{#3}} {#1}(#2,Y)}
\newcommand{\toto}{\rightrightarrows}
\newcommand{\trim}{\mathrm{trim}}
\newcommand{\fplc}{finite-piecewise-linear and convex\xspace} %xspace for use in text
\newcommand{\conv}{\mathrm{conv}}
\newcommand{\ones}{\mathbbm{1}}
\newcommand{\aff}{\text{aff}}
\newcommand{\im}{\text{im}}
\newcommand{\strip}{\mathrm{strip}}
\newcommand{\card}{\textbf{card}}

\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\arginf}{arg\,inf}
\DeclareMathOperator*{\sgn}{sgn}

\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\newtheorem{proposition}{Proposition}
\newtheorem{definition}{Definition}
\newtheorem{corollary}{Corollary}
\newtheorem{conjecture}{Conjecture}
\newtheorem{notation}{Notation}




\begin{document}

\section{Notation and Definitions}


Let $\Y$ be a finite outcome space, with $n:=|\Y|$, and $\Delta(\Y)$ be the set of probability distributions over $\Y$.

We define the \emph{level set} of a property at report value $r\in\R$ to be the set $\Gamma_r := \{p\in\P : r \in \Gamma(p)\}$.
Additionally, we can consider an unlabeled level set $\theta$ as this same set of distributions, but not associated with the report $r$.

A set $\Theta \subseteq 2^{\Delta(\Y)}$ is an unlabeled property, and finite if $|\Theta| < \infty$.
Observe that $\Theta$ is a set of level sets, and not a function.
%\raft{Careful: $\Theta$ does not need to divide anything; $\Theta = \{\emptyset\}$ is technically an unlabeled (degenerate) property JF: Changed}


\begin{definition}
Let $\Gamma:\P\toto\R$.
Define $\text{strip}(\Gamma) := \{ \Gamma_r : r \in \R \}$.
\end{definition}
Informally, strip removes labels from the property.
\jessie{Note: Strip includes the boundaries of level sets / lower dimensional level sets.}

%\begin{notation}
%We will use the following notation: $\Gamma' = \Gamma \cap \R'$ is the property $\Gamma' : p \mapsto \Gamma(p) \cap \R'$.  
%\end{notation}

%\begin{notation}
%\jessiet{TODO: REVISIT THIS.  See Notation 3}
%  Consider two labeled properties $\gamma : \P \toto \R'$ and $\Gamma : \P \toto \R$.
%  We say $\gamma \preceq \Gamma$ if removing reports from $\Gamma$ yields $\gamma$.
%  That is, if $\gamma = \Gamma \cap \varphi(\R')$ for some injection $\varphi : \R' \to \R$.
%  Note that $\varphi(\R') \subseteq \R$.
%\end{notation}
\begin{notation}
%\jessie{Attempt 2 of the above}
Let $\gamma: \P \toto\R'$ and $\Gamma: \P \toto\R$.
We say $\gamma \preceq \Gamma$ if for all $p \in \P$, we observe $\gamma(p) \subseteq \Gamma(p)$.
\end{notation}

\begin{definition}
	\jessiet{Not sure we need this, but I feel like it might be useful in the future for showing uniqueness up to a relabeling.}
	Let $\gamma$ and $\zeta$ be set-valued properties.
	We say $\gamma~\approx~\zeta$ if $\strip(\gamma)~=~\strip(\zeta)$.
\end{definition}

Observe that for every set of properties $\gamma: \P \toto \R'$ and $\zeta: \P \toto \R$ such that $\gamma \approx \zeta$, there is a bijection $\phi:\R' \to \R$ so that $\phi(\gamma(p)) = \zeta(p)$ for all $p \in \P$.
We slightly abuse notation and, given the finite set $S$, write $\phi(S) := \{\phi(x) : x \in S \}$.
($\phi$ is real valued, but we might be taking $\phi$ on every element of a (finite?) set.)

\begin{definition}
	The elicitable property $\Gamma:\P\toto \R$ is a \emph{J-embedding} of $\gamma: \P \toto \R'$ if there exists a property $\zeta : \P \toto \R$ so that $\zeta \preceq \Gamma$ and $\gamma \approx \zeta$.
\end{definition}

%\begin{conjecture}
%Consider a nondegenerate $\gamma:\P \toto\R'$ and $\Gamma: \P \toto\R$.
%For any bijection $\phi: \R' \to \bar \R$ and property $\zeta : p \mapsto \phi(\gamma(p))$, we observe that $\gamma \preceq \Gamma \iff \zeta \preceq \Gamma$.
%\end{conjecture}
%\begin{proof}
%Assume $\gamma \preceq \Gamma$.
%Then there is an injection $\varphi: \R' \to \R$ so that $\varphi(\gamma(p)) \in \Gamma(p)$ for all $p\in \P$.
%Consider $\bar \R = \phi(\R')$, and define the injection $\bar \varphi: \bar \R \to \R$ so that $\bar \varphi: \phi(r) \mapsto \varphi(r)$. 
%
%Consider $\strip(\gamma)  = \{\Gamma_r : r \in \R' \} = \{ \Gamma_{r} : \phi(r) \in \bar \R \} = \strip(\zeta)$. 
%Therefore, $\gamma \approx \zeta$.
%Since $\zeta(p) = \phi(\gamma(p))$, we know that $\bar \varphi (\zeta(p)) = \varphi(\gamma(p))$.
%%Since $\strip(\gamma) = \strip(\zeta)$, we then know that for all $p \in \P$, that $p \in \gamma_r \iff p \in \zeta_{\phi(r)}$, and therefore $\varphi(\gamma(p)) \in \Gamma(p) \iff \bar \varphi(\zeta(p)) \in \Gamma(p)$.
%
%Thus, $\varphi(\gamma(p)) \in \Gamma(p) \iff \bar{\varphi}(\zeta(p)) \in \Gamma(p)$, so we conclude $\zeta \preceq \Gamma$.
%The other direction follows with the same logic, using $\phi^{-1}$.
%\end{proof}
%
%In this case, we say $\zeta$ is a relabeling of $\gamma$.

\begin{definition}
A property $\Gamma: \P \to \R$ is \emph{finite} if $\im(\Gamma) := \{r\in\Gamma(p) : p\in\P, r \in \R \} = \bigcup_{p\in\P} \Gamma(p)$ is a finite set.
\end{definition}




Other notes before starting:
\begin{itemize}
%\item (Assuming the metric space is $(\Delta(\Y), \rho)$, where $\rho$ is Euclidean distance, although I don't think the choice of metric matters?).
%We just use this looking at interiors of level sets.
\item Using generalized Lebesgue measure on $\P \subset \reals^{|\Delta(\Y)|-1}$
\item The interior of a level set $X_r$ is defined as $\inter{X_r} = \{p \in X_r: \epsilon > 0,  \forall q \in B(\epsilon,p), r \in \argmin_r \E_q L(r,Y)\}$
%\item Define the boundary of the closed set $X$ by $bd(X) := X \setminus \inter{X}$.
\item A convex level set $\theta$ is \emph{full-dimensional} if it has nonempty interior. %% old: $dim(\aff(\theta)) = dim(\P)$. 
%Equivalently, $\theta$ is full-dimensional if there are distributions $p_1, p_2, \ldots, p_n \in \theta$ so that $p_1, \ldots, p_n$ are affinely independent.
%\raft{Careful; I think you need convexity here.  Probably you want to define full-dimensional as having nonempty interior, and prove this as a consequence of convexity.}
%\jessiet{What is the formal, ``universal'' definition of full-dimensional, if one exists?}
%\item A full-dimensional level set has non-empty interior.
\end{itemize}

\section{Conjectures and Lemmas on the way}

\begin{conjecture}\label{conj:gam-prime-exists}
	Let $\Gamma:\P \toto \reals^d$ be a nondegenerate elicitable property with a finite set of full-dimensional level sets $\Theta$ so that $\bigcup_{\theta \in \Theta}\theta = \P$.
	There exists a nondegenerate, nonredundant property $\gamma$ such that $\gamma \preceq \Gamma$. 
\end{conjecture}
\begin{proof}
\emph{Assumptions used: Finite level sets}

	
%	To start, construct $\R' := \{ r \in \R : \inter{\Gamma_r} \neq \emptyset \} \subseteq \R$.
%	Since $\card(\R') \leq \card(\reals^d)$, there is an injection $\varphi:\R' \to \reals^d$.
%	Observe that $\R'$ is finite and nonempty.
	Construct the finite set $\R' = \{\Gamma(p) : p \in \inter{\theta} \}_{\theta \in \Theta}$. \jessie{TODO- Check this is how we want to construct $\R'$.}
	Defining the property $\gamma : p \mapsto \Gamma(p) \cap \R'$, we see that $\gamma \preceq \Gamma$.
	We want to show that the constructed $\gamma$ is nondegenerate and nonredundant.
	As $\Gamma$ is nondegenerate, there is some report $r \in \reals^d$ such that $r \in \Gamma(p)$.
	For every $p \in \P$, there is some level set $\theta$ so that $p \in \cl{\theta}$, and since level sets of elicitable properties are closed (see Lemma~\ref{lem:closed-level-sets}), and therefore $p \in \theta$.
	Thus there is some report $r \in \R'$ so that $r \in \gamma(p)$, so $\gamma$ is nondegenerate.
%	If $p \in \inter{\Gamma}_r$, then by construction of $\R'$, we see $r \in \R'$.
%	Since level sets are closed, for any $r \in \R'$, we know that $\varphi(r) \in \Gamma(q)$ for all $q \in bd(\Gamma_{\varphi(r)})$, and therefore there is at least one report $r \in \R'$ such that $\varphi(r) \in \Gamma(p)$ for all $p \in \P$, so $\gamma$ is nondegenerate. 

	If $\gamma$ is redundant, then remove any redundant reports from $\R'$.
	Any level set with a redundant report must either (a.) equal to another level set (b.) a proper subset of another level set, or (c.) span multiple level sets.
	Removing redundant reports resolves (a.) and (b.).
	As $\Gamma$ is elicitable, we can see that (c.) cannot happen.
	First consider that any redundant report $r$ spanning multiple level sets cannot be full dimensional, as we would contradict elicitability of $\Gamma$ as the score $G$ must be convex, and therefore differentiable almost everywhere in the simplex.
	If the level set $\Gamma_r \subseteq \Gamma_{r_1}$ or $\Gamma_{r_2}$ for $r_1$ and $r_2 \in \R'$, then we have case (b.).
	If there is some $p \in \Gamma_r$ so that $p \not \in \Gamma_{r_1} \cap \Gamma_{r_2}$, but there is some $p \in \Gamma_{r_1} \cap \Gamma_r$ and $q \in \Gamma_{r_2} \cap \Gamma_r$, then there must be some $s \in \Gamma_r \cap \Gamma_{r_1} \cap \Gamma_{r_2}$ as the level set $\Gamma_r$ must be convex.
	At $s$, the	subgradient set of the score $G$ is a two-dimensional closed and convex set, 
	\jessie{... to do}
	
	Therefore, there will be at least one $r \in \R'$ per distribution, and as level sets are closed, so $\gamma$ will still be nondegenerate.
	Therefore, our constructed $\gamma$ is nondegenerate, nonredundant, and $\gamma \preceq \Gamma$.
	
%	\jessie{Skip this paragraph if you believe the last sentence by simply citing closure.}
%	Thus, we just need to show $\Gamma'(p) \neq \emptyset$ for $p \not \in \inter{\Gamma_r}$.
%	As $\Gamma$ is nondegenerate, there are then $m$ level sets $\{\Gamma_{r_i}\}_{i=1}^m$ in the $\epsilon$-ball around $p$.
%	We claim some $r_i$ is in $\R'$.
%	Since there are only a finite set of level sets, at least one in the $\epsilon$-ball centered on $p$ is full dimensional.
%	Therefore, there is some $r_i \in \R'$ so that $p \in cl(\Gamma_{r_i})$, and as level sets are closed by Lemma~\ref{lem:closed-level-sets}, we then observe $p \in \Gamma_{r_i}$.
%	Therefore $\Gamma'$ is nondegenerate.
%	\jessie{End the paragraph you can skip}
	
%%% COMMENTED OUT 10/19/18
%%%	Now to show $\gamma$ is nonredundant.
%%%	For contradiction, suppose $\gamma$ is redundant.
%%%	Then there are $r_1, r_2 \in \R'$ with $r_1 \neq r_2$ with full dimensional level sets $\Gamma_{r_1}$ and $\Gamma_{r_2}$ so that either $\gamma_{r_1} \subsetneq \gamma_{r_2}$ or $\gamma_{r_1} = \gamma_{r_2}$.
%%%	
%%%	\jessie{Uses a fact that requires nonredundancy to show nonredundancy... change this proof.  Or think about what it's not true.}
%%%	First, suppose $\gamma_{r_1} = \gamma_{r_2}$.
%%%	We can think as the property values as labelings of the subgradient sets (denoted by $\partial$) of the the concave Bayes Risk $G(p)$.
%%%	\jessie{Need source: Gneiting/Raftery 2007\footnote{\url{https://www.stat.washington.edu/raftery/Research/PDF/Gneiting2007jasa.pdf}} or Raf/Ian 2014\footnote{\url{http://www.cs.colorado.edu/~raf/media/papers/wine-affine.pdf}}}
%%%	As $G$ is concave, it is differentiable almost everywhere, which means that $|\partial G(p)| = 1$ almost everywhere.
%%%	Then $\gamma(p) = \partial G(p) \implies |\gamma(p)| = 1$ almost everywhere, which-- along with the fact that the level sets $\gamma_{r_1}$ and $\gamma_{r_2}$ are full dimensional (and therefore have positive measure since they are convex-- see Lemma~\ref{lem:pos-measure-iff-nonempty-int}), contradicts the claim $r_1 \neq r_2$.
%%%	Thus we conclude there aren't reports $r_1, r_2 \in \R'$ so that $r_1 \neq r_2$ and $\gamma_{r_1} = \gamma_{r_2}$.
%%%	
%%%%	By construction of $\R'$, we know both $\Gamma'_{r_1}$ and  $\Gamma'_{r_2}$ are full dimensional.
%%%%	If $\Gamma'_{r_1} = \Gamma'_{r_2} = \Gamma'_{r_1} \cap \Gamma'_{r_2}$ are full dimensional, this contradicts something?
%%%	
%%%	Otherwise suppose $\gamma_{r_1} \subsetneq \gamma_{r_2}$.
%%%	As $\gamma_{r_1}$ is full-dimensional, so is $\gamma_{r_1} \cap \gamma_{r_2} = \gamma_{r_1}$.
%%%	Again, since we know that $|\gamma(p)| = 1$ almost everywhere, and as the intersection of the two level sets is full-dimensional, this again contradicts the differentiability of $G$ almost everywhere, since the intersection of the level sets has positive measure in the simplex.
%%%	Therefore, $\gamma$ is nonredundant.
%%% END COMMENTED OUT 10/19/18
\end{proof}


\begin{lemma}\label{lem:define-trim}
	Let $\Gamma$  be a nondegenerate, elicitable property with a finite set of level sets $\Theta$ so that $\bigcup_{\theta \in \Theta} \theta = \P$.
	There exists an unlabeled property $\Theta$ so that for all nondegenerate, nonredundant $\gamma \preceq \Gamma$, we have $\strip(\gamma) = \Theta := \text{trim}(\Gamma)$.
\end{lemma}

\begin{proof}
	Let $\gamma: \P \toto \R'$, and $\Gamma: \P \toto \reals^d$.
	For contradiction, suppose there was some other nondegenerate, nonredundant $\zeta: \P \toto \R$ so that $\zeta \preceq \Gamma$.
	For any $\zeta \approx \gamma$, we know $\strip(\zeta) = \strip(\gamma)$.
	If $\zeta \not \approx \gamma$, then $\card(\R') \neq \card(\R)$.
	If $\card(\R') > \card(\R)$, then we either contradict nondegeneracy of $\zeta$ or nonredundancy of $\gamma$ and contradict nondegeneracy of $\gamma$ or nonredundancy of $\zeta$ with the other direction of inequality.
	Thus, we must have $\gamma \approx \zeta$, and conclude $\strip(\gamma)$ is unique.

	
%	We just want to show $\trim(\Gamma)$ is unique because of Conjecture~\ref{conj:gam-prime-exists}.	
%	Consider two nonredundant, nondegenerate properties $\Gamma' = \Gamma \cap \R' \preceq \Gamma$ and $\tilde \Gamma  = \Gamma \cap \tilde \R \preceq \Gamma$.
%	It is sufficient to show $\Theta' := \strip(\Gamma') = \strip(\tilde \Gamma) =: \tilde \Theta$.
%	
%	First, fix a level set $\theta \in \Theta'$.
%	There is some report $r'$ so that $r' \in \Gamma(p) \cap \R'$ for all $p \in \theta$ by nondegeneracy of $\Gamma'$.
%	Now, for contradiction, suppose $\Gamma'_{r'} \not\in \strip(\tilde \Gamma)$.
%	Therefore, there is \emph{not} a report $r \in \tilde \R$ so that $\Gamma'_{r'} = \tilde \Gamma_r$.
%%	Now, if $\tilde \Gamma(p) = \emptyset$ for some $p \in \theta$, then we contradict nondegeneracy of $\tilde \Gamma$.
%	
%	As $\Gamma' \preceq \Gamma$ and $\tilde \Gamma \preceq \Gamma$, then for some $r \in \tilde \R$, we then see that either $\Gamma'_{r'} \subsetneq \tilde \Gamma_r$ or $\tilde \Gamma_r \subsetneq \Gamma'_{r'}$ since both $\Gamma'$ and $\tilde \Gamma$ are restrictions of the property $\Gamma$.
%%	(If the level sets are not equivalent, then the intersection $\Gamma'_{r'} \cap \tilde{\Gamma_r}$ must be lower dimensional by nonredundancy of $\Gamma'$ and $\tilde{\Gamma}$ since $\partial G$ is real-valued amost everywhere.)
%	The first case contradicts nonredundancy of $\Gamma'$ and the latter contradicts nonredundancy of $\tilde \Gamma$.
%	Thus, there must be some $r \in \tilde{\R}$ so that $\Gamma'_{r'} = \tilde{\Gamma_r}$, so we conclude $\Gamma'_r \in \strip(\tilde \Gamma)$.
%	
%	The other direction of inclusion follows from the same logic.
%	Therefore, for all nonredundant, non-degenerate properties $\Gamma' \preceq \Gamma$, we observe the unique unlabeled property $\trim(\Gamma) := \Theta = \strip(\Gamma')$.
%	
%	\jessie{If we think about bijections, consider the bijection $\phi: \R' \to \tilde \R$.
%	Then $\strip(\Gamma') = \{ \Gamma'_{r} : r \in \R' \} = \{ \Gamma_{\varphi(r)} : r \in \R' \} = \{ \Gamma_{\varphi(r)} : \phi(r) \in \tilde \R \} = \{ \tilde \Gamma_{\phi(r)} : \phi(r) \in \tilde \R \} = \strip(\tilde \Gamma) $, then it's simpler to state.}
	
\end{proof}




\begin{conjecture}\label{conj:trim-full-dim}
	Consider a nondegenerate, elicitable property $\Gamma$ with finitely many level sets.
	Every $\theta \in \Theta := \trim(\Gamma)$ is full-dimensional  
\end{conjecture}

\begin{proof}[Proof Sketch]
	\emph{Uses: Conjecture~\ref{conj:gam-prime-exists}.}
	
	In order to understand what $\trim(\Gamma)$ is, we use the property $\gamma \preceq \Gamma$ and $\R'$ constructed in Conjecture~\ref{conj:gam-prime-exists}.
	For each $\theta \in \trim(\Gamma) = \strip(\gamma)$, there must be a report $r \in \R'$ such that $\theta = \gamma_r = \Gamma_{r}$.
	By construction, $r \in \R' \implies \inter{\gamma_r} = \inter{\theta} \neq \emptyset$.
	Since $\theta$ is convex (as level sets of elicitable properties are) and has nonempty interior, then $\theta$ is full dimensional. 
	
%	First, we see $\Theta := \trim(\Gamma) = \strip(\Gamma')$ is nonredundant in the unlabeled definition (Definition~\ref{def:unlabeled-nonredundant}) as $\Gamma'$ is nonredundant in the labeled set from Lemma~\ref{lem:nonredundant-defs-equivalent}, since we know $\Gamma'$ is well-defined and nonredundant from Conjecture~\ref{conj:gam-prime-exists}.
%	
%	
%	
%	For contradiction:
%	Let $\theta \in \Theta$ not full-dim and non-redundant (whatever that means for an unlabeled property-- see definition \ref{def:unlabeled-nonredundant} section for proposed definition).
%	
%	We now show that every level set $\theta \in \Theta = \strip(\Gamma') = \trim(\Gamma)$ is full dimensional.
%	
%	We proceed in 2 cases for a level set $\theta \in \Theta$:
%	\begin{enumerate}
%		\item For all $\theta' \in \Theta$, $\theta \cap \theta' = \emptyset$.
%		\jessie{Doesn't this only happen when $\{\theta\} = \Theta$?}
%		
%		We know the level set $\theta$ is closed by Lemma~\ref{lem:closed-level-sets}.
%		By definition of $\R'$, for $p \in \inter{\theta}$ so that for $r_\theta = \Gamma'(p)$, there is a ball $B(\epsilon, p)$ centered around $p$ so that for every $q \in B(\epsilon, p)$, $r_\theta \in \Gamma'(q)$.
%%		(In fact, as $\Theta$ is nonredundant, we claim $r_\theta = \Gamma'(q)$. \jessie{Need to show?})
%		Therefore, the level set $\Gamma_{r_\theta} = \theta$ is full dimensional as it has nonempty interior.
%		
%		Intuitively, this can be seen since the interior of $\theta$ is nonempty by nondegeneracy of $\Gamma'$.
%		
%		\bigskip
%		\hrule
%		Other notes from meeting with Raf 9/24/18:\\
%		Use closure and nondegeneracy
%		
%		Look at subset topology? ($\tau_{\R'} := \{\R' \cap U : U \in \tau \}$.)
%		
%		\hrule
%		\item There exists a level set $\theta' \in \Theta$, $\theta \cap \theta' \neq \emptyset$.
%		
%		By nonredundancy of $\Gamma'$, we then observe nonredundancy of $\Theta$, we know that $\mu(\theta \cap \theta') = 0$.
%		We want to show that $\theta$ is full dimensional.
%		
%		For contradiction, suppose $\theta \in \trim(\Gamma)$ is not full dimensional.
%		By Conjecture~\ref{conj:gam-prime-exists}, there exists a nonredundant, nondegenerate $\Gamma' \preceq \Gamma$ so that $\trim(\Gamma) = \strip(\Gamma')$.
%		Consider $\R'$ so that $\Gamma' = \Gamma \cap \R'$ as constructed in the proof of Conjecture~\ref{conj:gam-prime-exists}.
%		
%		Suppose $\theta \in \trim(\Gamma)$ is not full dimensional.
%		Then $\inter{\theta} = \emptyset$.
%		As $\trim(\Gamma) = \strip(\Gamma')$, we observe that there is a unique $r \in \R'$ so that $\Gamma'_r = \theta$.
%		However, $\inter{\theta} = \inter{\Gamma'_r} = \emptyset \implies r \not \in \R'$ by the construction of $\R'$.
%		Since $\trim(\Gamma) = \strip(\Gamma')$ \emph{for all} nonredundant, nondegenerate $\Gamma' \preceq \Gamma$-- including the $\Gamma'$ constructed in the proof of Conjecture~\ref{conj:gam-prime-exists}, then we conclude $\Gamma_r = \theta \not \in \strip(\Gamma') = \trim(\Gamma)$.
%		
%		
%		\bigskip
%		\hrule
%		Other notes from meeting:\\
%		Look at expected loss/score of $\Gamma'$.
%		\hrule
%	\end{enumerate}
	
%	Therefore, we have a contradiction and conclude $\theta \in \trim(\Gamma)$ is full dimensional. 
\end{proof}


\begin{conjecture}\label{conj:lev-sets-subsets}
	Let the elicitable property $\Gamma: \P \toto \reals^d$ embed the nondegenerate property $\gamma$.
	Then the level sets of $\Gamma$ are subsets of the level sets of $\gamma$.
\end{conjecture}

\begin{proof}
	\jessie{Original def of embedding}
	Showing the level sets of $\Gamma$ are subsets of the level sets of $\gamma$ is to show that $\forall r \in \reals^d$ we know $p \in \Gamma_r \implies p \in \gamma_{r'}$ for some $r' \in \R'$.
    \raf{Want to say $\forall r$ $\exists r'$ $p \in \Gamma_r \implies p \in \gamma_{r'}$.}
    
%	Consider $p \in \Gamma_r$.
%	Then $r \in \Gamma(p)$, and since $\Gamma$ embeds $\gamma$, we know $ r = \varphi(r') \in \gamma(p)$ and $r' \in \R'$.
%	We then know that $p \in \gamma_{r'}$.
	Consider $r_1 \in \reals^d$ and $r_2 \in \R'$.
	Suppose $q \in \Gamma_{r_1}$ but $q \not \in \gamma_{r_2}$.
	There must be no $r_2 \in \R'$ so that $\varphi(r_2) = r_1$.
	Then $q \not \in \gamma_{r_2}$ contradicts the the fact that $\Gamma$ embeds $\gamma$.
	Thus, $p \in \Gamma_{r_1} \implies \exists r_2 \in \R'$ so that $p \in \gamma_{r_2}$ .
	
	Therefore, every level set of the property $\Gamma$ is a subset of a level set of $\gamma$.
	\jessie{End embedding}
	
	\jessie{Begin J-embedding}
	Since $\Gamma$ embeds $\gamma$, there is a nondegenerate, nonredundant $\zeta$ so that $\zeta \preceq \Gamma$ and $\zeta \approx \gamma$.
	Therefore, it is sufficient to show $\theta \in \strip(\Gamma) \implies \theta \in \strip(\zeta)$.
	We know for all $p \in \P$ that $\zeta(p) \subseteq \Gamma(p)$.
	Therefore, for every $r \in \reals^d$, there is some $r' \in \reals^d$ so that $ p \in \theta = \Gamma_r = \{ p \in \P : r \in \Gamma(p) \} \subseteq \Gamma_{r'} \implies p \in \Gamma_{r'} \iff p \in \{ p \in \P : r' \in \zeta(p) \} = \zeta_{r'}$ as $\zeta(p) \subseteq \Gamma(p)$ by closure of level sets (since if a level set is lower-dimensional, there is some full-dimensional level set that it is a subset of).
	\jessie{End J-embedding}
\end{proof}


%\begin{lemma}\label{lem:intersect-lev-sets}
%  Let the elicitable property $\Gamma$ have a finite set $\Theta$ of full-dimensional level sets, so that for all $\theta \in \Theta$,  there is a unique optimal report $r_\theta$ for all $p \in \inter{\theta}$.
%  Consider the finite set $\R' := \{ r_\theta\}_{\theta \in \Theta}$.
%  Then for every $r \in \R$, there exists a finite set $R \subseteq \R'$ so that $\Gamma_r = \bigcap_{r' \in R} \Gamma_{r'}$.
%\end{lemma}
%%\jessie{To show: can find set $R$ s.t. $\Gamma_r = \bigcap_{r' \in R} \Gamma_{r'}$, and $R$ is finite.}
%\begin{proof}
%  \emph{Facts used: Level sets are closed (Lemma \ref{lem:closed-level-sets}), non-degeneracy of $\Gamma$.}\\
%
%  Note:    As $\Gamma$ is non-degenerate, we know for all $p \in \P$ that $|\Gamma(p)| \geq 1$.
%  For any $p \in \P$, if $|\Gamma(p)| = 1$, then $\Gamma(p) = r \in \R'$, so we can choose $S := \{r\} \subseteq \R'$ so that $\Gamma_r = \cap_{r \in S} \Gamma_r$.
%  
%  In general, if $\Gamma(p)$ is set-valued, there is some collection $S \subseteq \R$ so that $p \in \bigcap_{r \in S} \Gamma_r$.
%  We want to find set a \emph{finite} set $S \subseteq \R'$ so that the previous statement is true.
%  ($S$ is not necessarily finite, but we want to show there is a finite $S$ so that's true.)
%
%Construct the finite set $S_r := \{ r_i \in \R' : \forall q \in \Gamma_{r}, \exists p \in \Gamma_{r_i} \text{ s.t. } p \in B(\epsilon, q) \}$.
%In words, $S_r$ is the set of reports that are uniquely optimal for some distribution in the $\epsilon$ ball around any $p \in \Gamma_r$.
%$S_r \subseteq \R'$ by construction, so $S_r$ is finite. 
%We then just want to show the equivalence of $\Gamma_r$ and $\cap_{r' \in S_r}\Gamma_{r'}$.
%
%($\subseteq$)  We want to show $\Gamma_r \subseteq \cap_{r' \in S_r}\Gamma_{r'}$
%Let $q \in \Gamma_r$.
%If $q \in \Gamma_r$, then for every $r_i \in S_r$, there is some $p \in \inter{\Gamma_{r_i}}$ so that $p \in B(\epsilon, q)$.
%Since $q$ is $\epsilon$-close to $p$, then we observe $q \in cl(\Gamma_{r_i})$.
%\jessie{A bit hand-wavvy}
%
%As level sets are closed (by Lemma \ref{lem:closed-level-sets}), $\Gamma_{r_i} = cl(\Gamma_{r_i})$, so $q \in \Gamma_{r_i}$.
%%Thus as $q \in \Gamma_r \implies q \in \Gamma_{r_i}$ for all $r_i \in S_r$, $q \in \Gamma_r \implies q \in \cap_{r_i \in S} \Gamma_{r_i}$.
%Thus as $q \in \Gamma_r \implies q \in \Gamma_{r_i}$ for all $r_i \in S_r$, we observe $\Gamma_r \subseteq \cap_{r_i \in S}\Gamma_{r_i}$.
%
%\bigskip 
%($\supseteq$)  Now suppose the distribution $t \in \cap_{r_i \in S_r}\Gamma_{r_i}$.
%We want to show $t \in \Gamma_r$.
%
%As $t \in \cap_{r_i \in S_r}\Gamma_{r_i}$, we know for every $r_i \in S_r$ that $t \in \Gamma_{r_i}$.
%
%Since each $r_i \in S_r$, that means that for every $q \in \Gamma_r$, there is a distribution $p \in \Gamma_{r_i}$ that is in the $\epsilon$-ball $B$ around $q$.
%As this is true for every $r_i \in S_r$, the distribution $t \in B(\epsilon, q)$ for some $q \in \Gamma_r$. 
%Therefore, as level sets are closed, $t \in B(\epsilon, q) \implies t \in cl(\Gamma_r) \implies t \in \Gamma_r$.
%Thus, $\cap_{r_i \in S_r}\Gamma_{r_i} \subseteq \Gamma_r$.
%
%Therefore, by constructing the finite set $S_r$, we observe there is a finite set $S_r := R \subseteq \R' \subseteq \R$ such that for every $r \in \R$, we observe $\Gamma_r = \cap_{r_i \in R}\Gamma_{r_i}$.
%
%\end{proof}




\section{Defining embeddability}


\begin{proposition}\label{prop:optimal-reports-per-level-set}
  Let $\Gamma:\P\toto\reals^d$ be a non-degenerate elicitable property.

  The following are equivalent:
  \begin{enumerate}
  \item There is a nondegenerate, finite property $\gamma:\P\toto\R'$ and $\R \subseteq \reals^d$ such that there is an injection $\varphi:\R'\to\reals^d$ such that $r\in\gamma(p) \iff \varphi(r) \in \Gamma(p)$. (i.e. $\Gamma$ embeds finite $\gamma$).  
%  \jessie{Note: If $\R = \varphi(\R')$, then $\varphi': \R' \to \R$ with $\varphi': r \mapsto \varphi(r) \cap \R$ is a bijection, if we want to talk about inverses.}
  \item There is a finite set of full dimensional level sets $\Theta$ of $\Gamma$ that union to $\P$.
  \item There is a finite set $\Theta \subseteq \strip(\Gamma)$ of full-dimensional level sets, such that: (a) $\bigcup_{\theta\in\Theta} \theta = \P$%, (b) for all $\theta \in \Theta$, there exists an $r_\theta \in \R$ such that $\Gamma(p) = \{r_\theta\}$ for all $p \in \inter{\theta}$.
  \item $\strip(\Gamma)$ is finite.
  \item $\trim(\Gamma)$ is finite.
  \item $\trim(\Gamma)$ is finite and elicitable.

  
  \end{enumerate}
\end{proposition}

\begin{proof}
%\jessie{Old: First, we show $5 \iff 4$ then proceed in a cycle to show $1 \implies 3 \implies 2 \implies 6 \implies 5 \implies 1$.
%	Also old: We proceed in a cycle to show $5 \implies 1 \implies 6 \implies 2 \implies 3 \implies 4 \implies 5$.	}
We proceed in a cycle to show $5 \implies 1 \implies 6 \implies 2 \implies 4 \implies 5$.

\begin{enumerate}
%%%	\item [$3 \implies 2$]
%%%	We know $\trim(\Gamma) \subseteq \strip(\Gamma)$, and if $\strip(\Gamma)$ is finite, then any subset of $\strip(\Gamma)$ is finite.
	
%%% Commented out 10/17/18
%%%	\item[$5 \iff 4$] 
%%%	We know $\trim(\Gamma) \subseteq \strip(\Gamma)$, and if $\strip(\Gamma)$ is finite, then any subset of $\strip(\Gamma)$ is finite.
%%%	Thus we just show $5 \implies 4$.
%%%	
%%%	Consider $\trim(\Gamma)$ to be finite.
%%%%	If $\Gamma$ is nonredundant, then we are finished, as $\Gamma \preceq \Gamma$ and would be nondegenerate and nonredundant, so we can say $\trim(\Gamma) = \strip(\Gamma)$.
%%%	We know there is a nonredundant, nondegenerate $\Gamma' \preceq \Gamma$ so that $\strip(\Gamma') = \trim(\Gamma)$ by Conjecture~\ref{conj:gam-prime-exists} and the definition of trim.
%%%	We take $\Gamma'$ and $\R'$ as constructed in Conjecture~\ref{conj:gam-prime-exists}.
%%%	We then want to show $\strip(\Gamma) = \strip(\Gamma') \bigcup S$, where $S$ is some finite set.
%%%	Consider the level set $\Gamma_r$ for $r \in \R$.
%%%	If $r \in \R'$, then $\Gamma_r \in \strip(\Gamma')$.
%%%	If $r \not \in \R'$, then the level set $\Gamma_r$ has empty interior by construction of $\R'$.
%%%	%\jessie{Need argument about how we can only have level sets on the boundary.}
%%%	
%%%	Since $\Gamma$ is elicitable, the score $G(p)$ is concave, thus differentiable almost everywhere in the probability space $\P$.
%%%	Thus, every level set with nonempty interior has $|\partial G(p)| = |\Gamma(p)| = 1$ for all $p \in \inter{\theta}$, and there is then a report $r \in \R'$ so that $\theta \in \Gamma_r$.
%%%	
%%%	Thus, we concern ourselves with the case $|\partial G(p)| > 1$.
%%%	%If $|\partial_p G(p)| = 1$ for some $p \in\theta$, then the interior $\inter{\theta} \neq \emptyset$, implying $r \in \R'$ by closure of level sets, so we must concern ourselves with the case $|\partial_p G(p)| > 1$.
%%%	As subgradient sets are closed, there exists a finite set of full dimensional level sets $\{\theta_i\}_{i=1}^m$ in the $\epsilon$-ball around each $p \in \theta$ so that for any $p_i \in \inter{\theta_i}$, we observe $\partial G(p_i) \neq \partial G(p_j)$ for all $i \neq j$ and $\partial G(p_i) = \Gamma(p) = \{r_i\}$ for all $1 \leq i \leq m$.
%%%	Additionally, as level sets are closed, we claim $p \in \Gamma_{r_i}$ for all $1 \leq i \leq m$.
%%%	Therefore, $p \in \theta \implies p \in \bigcap_{r' \in \{r_i\}_{i=1}^m} \Gamma_{r'}$ for some $\{r_i\}_{i=1}^m \subseteq \R'$.
%%%	As $\R'$ is finite, so is the power set $2^{\R'}$, so the set $S = \{\Gamma_r : r \in \R \setminus \R' \}$ is finite.
%%%	Therefore $\strip(\Gamma) = \strip(\Gamma') \cup S$ is finite. 
%%%End commented out 10/17/18
	
%%%\item [$1 \implies 2$]
%%%Suppose that we define $\trim(\Gamma) = \strip(\Gamma')$ for the nonredundant, nondegenerate property $\Gamma \cap \R' = \Gamma' \preceq \Gamma$ as constructed in Conjecture~\ref{conj:gam-prime-exists}.
%%%
%%%Consider $\strip(\Gamma') = \{\Gamma_r : r \in \R'\}$, so it is sufficient to show $\R'$ is finite.
%%%Since $\Theta$ is the set of full-dimensional level sets, and $\R'$ is defined as the set of reports corresponding to level sets with nonempty interior (i.e. full-dimensional), then $\R' = \{r_\theta\}_{\theta \in \Theta}$ is finite as $\Theta$ is finite.
%%%(Note that $r_\theta$ is unique for each level set because of nonredundancy of $\Gamma'$.)
%%%Therefore, $\trim(\Gamma)$ is finite.


%%% means taken out to reduce space and make the proof a loop 10/12/18
%%%\item [$2 \implies 1$]
%%%Consider $\trim(\Gamma) = \Theta$.
%%%$\Theta$ is then finite and a subset of strip by definition, and by Conjecture~\ref{conj:trim-full-dim}, every $\theta \in \Theta$ is full dimensional.
%%%Consider that $\trim(\Gamma) = \strip(\Gamma')$ for the property $\Gamma'$ constructed in Conjecture~\ref{conj:gam-prime-exists}, and as $\Gamma'$ is nondegenerate, then for every $p \in \P$, there is a $\theta \in \Theta$ such that $p \in \theta$, so the union of the level sets is then equal to the distribution set $\P$.
%%%Additionally, as $\Gamma$ is elicitable, the optimal report is unique almost everywhere by concavity of the score $G$.
%%%Therefore, if $p \in \inter{\theta}$ and the optimal report $r_\theta$ is unique almost everywhere, then as there is an $\epsilon$-ball around $p$ where every for every $p'$ in the ball, $p' \in B(\epsilon, p)$, $\Gamma(p) = \Gamma(p')$.


%We can rewrite $\strip(\Gamma) = \{\Gamma_{r'} : r' \in \R' \} \cup \{\Gamma_{r} : r \in \R \setminus \R' \}$.
%As the first set is finite, we just need to show $\{\Gamma_{r} : r \in \R \setminus \R' \}$ is finite in order to show $\strip(\Gamma)$ is finite.
%
%Let us consider some $r\in\R \setminus \R'$.
%The level set $\Gamma_r = \{p : \Gamma(p) = r\}$ by definition.
%As $r \not\in \R'$, the interior is empty; that is, $\inter{\Gamma_r} = \emptyset$.
%% For any $p \in \Gamma_r$, then, there is some $q \in B(\epsilon, p)$ such that $\E_q L(r', Y) < \E_q L(r,y)$ for some $r' \in \R'$.
%% As $r = \argmin_{\tilde{r}} \E_p L(\tilde{r}, Y)$, then we observe $\E_p L(r, Y) = \E_p L(r', Y) = \min_{\tilde{r}}\E_p L(\tilde{r}, Y)$ for $p \in \Gamma_r$. 
%% Thus, $\Gamma_r \subseteq \Gamma_{r'}$.
%By Conjecture \ref{lem:intersect-lev-sets}, there exist a set of finite reports $R \subseteq \R'$ such that $\bigcap_{r'\in R} \Gamma_{r'} = \Gamma_r$.
%As the set $\R'$ is finite, then the power set $2^{\R'}$ is finite.
%Thus, the set $\{ \Gamma_r : r \in \R \setminus \R' \} =  \{ \bigcap_{r_1 \in R} \Gamma_{r_1} : R \subseteq \R' \}$ is finite.
%
%
%The union of a two finite sets is then finite, so $\trim(\Gamma) \subseteq \strip(\Gamma) = \{ \Gamma_{r'} : r' \in \R' \} \cup \{ \Gamma_r : r \in \R \setminus \R' \}$ is finite.


%%%\item[$2 \implies 4$] \jessie{Shown in cvx-fin-notes.tex}
%Let $\Theta := \trim(\Gamma)$ be finite and $\Gamma$ elicited by the loss $L$.
%Construct $\R'$ as in Conjecture~\ref{conj:gam-prime-exists}.
%Restricting the loss $L|_{\R'}$ should then elicit $\trim(\Gamma)$.
%\jessie{TODO... I'm a little unclear here if I should show there's a report that minimizes the loss or a subgradient set that corresponds to each level set $\theta \in \Theta$, and thus, a labeling}

%%%\item[$5 \implies 2$] Consider a finite set of full dimensional level sets that union to $\P$: call it $S$.
%%%If we show $\trim(\Gamma) \subseteq S$, then $S$ finite $\implies \trim(\Gamma)$ finite.
%%%Consider some $\theta \in \trim(\Gamma)$.
%%%Then $\theta$ is full dimensional by Conjecture~\ref{conj:trim-full-dim}, so we conclude $\theta \in S$.
%%%Therefore, $\theta \in \trim(\Gamma) \implies \theta \in S$, so $\trim(\Gamma) \subseteq S$, and therefore $\trim(\Gamma)$ is finite.


%%%Commented out 10/17/18
%%%\item[$1 \implies 3$] 
%%%Let the elicitable property $\Gamma$ embed some finite property $\gamma$.
%%%Then since $\gamma$ is a finite set of level sets, and every level set of $\Gamma$ is a subset of a level set of $\gamma$ by Conjecture~\ref{conj:lev-sets-subsets}.
%%%
%%%Consider the finite set $\R'$ to be the range of $\gamma$.
%%%
%%%By Conjecture~\ref{conj:prec-if-embeds}, since $\Gamma$ embeds $\gamma$, we know that $\gamma \preceq \Gamma$, so $\Theta = \strip(\gamma) = \trim(\Gamma)$ is finite and every $\theta \in \Theta$ is full dimensional.
%%%Since $\Gamma$ is elicitable, the optimal report $r_\theta \in \Gamma(p)$ is unique almost everywhere on $\P$ (by differentiability of the score $G$ almost everywhere).
%%%Additionally, as $\gamma$ is nondegenerate, its level sets union to $\P$.
%%%
%%%For each level set $\theta \in \Theta$, there is a unique optimal report $\{r_\theta \} = \Gamma(p)$ for all $p \in \inter{\theta}$ by the elicitability of $\Gamma$.
%%%This can be seen by the differentiability of $G$ almost everywhere in $\P$, and thus uniqueness of $\Gamma(p)$ almost everywhere.
%%%A convex level set with nonempty interior has positive measure, so if $r_\theta$ was not unique on the interior of $\theta$, the set where $r_\theta$ is not unique would have positive measure, contradicting elicitability of $\Gamma.$
%%%
%%%Therefore the set $\Theta = \{\gamma_r : r \in \R' \} = \trim(\Gamma) \subseteq \strip(\Gamma)$ is a finite set of full dimensional level sets that union to $\P$ with a unique optimal report on the interior of each level set. 
%%%\item[$3 \implies 2$] Trivial
%%%\item[$2 \implies 6$]
%%%Let $\Theta$ be a set of full-dimensional level sets of $\Gamma$ that union to $\P$.
%%%First, we know $\Gamma$ is nondegenerate.
%%%
%%%The $\Gamma'$ constructed in Conjecture~\ref{conj:gam-prime-exists} has a finite codomain $\R'$ since $\R'$ is the set defined by the unique optimal report defined on the interior of each level set.
%%%Since there are only finitely many full-dimensional level sets, the set $\R'$ is finite.
%%%
%%%We then know by definition of $\trim$ that since $\Gamma'$ is nonredundant, nondegenerate, and $\Gamma' \preceq \Gamma$, that $\strip(\Gamma') = \trim(\Gamma)$ is finite.
%%%
%%%Therefore $\trim(\Gamma)$ is finite, and $L|_{\R'}$ elicits $\trim(\Gamma)$ from \emph{cvx-fin-notes.tex}.
%%%
%%%\item[$6 \implies 5$] Trivial
%%%End commented out 10/17/18

\item[$5 \implies 1$] 
\jessie{Begin proof using Raf's definition of embedding... skip below for J embedding}
Let $\trim(\Gamma)$ be finite.
Then there is a nondegenerate, nonredundant, finite property $\gamma: \P \to \R'$ and $\gamma \preceq \Gamma$ so that $\{ \gamma_r : r \in \R' \} = \strip(\gamma) = \trim(\Gamma)$, and we take $\gamma, \varphi$ as constructed in Conjecture~\ref{conj:gam-prime-exists}.
We want to show that $\Gamma$ embeds this property $\gamma$.
We know $\gamma$ is nondegenerate and finite by construction.

%Since we know $\card(\trim(\Gamma)) = \card(\R')$ is finite and $\trim(\Gamma)$ is a subset of the codomain of $\Gamma$, then $\card(\R')) \leq \card(\reals^d)$, so there is an injection $\varphi : \R' \to \reals^d$ \jessie{Citation if desired: from Folland Section 0.3}.
%\jessie{Let us construct $\R = \varphi(\R')$ so that $\bar \varphi: \R' \to \R$ is a bijection.}

Consider some $r \in \gamma(p)$.
Since $\varphi$ is an injection from $\R' \to \reals^d$, then $r \in \gamma(p) \implies \varphi(r) \in \varphi(\gamma(p)) \subseteq \Gamma(p) \implies \varphi(\gamma(p)) \in \Gamma(p)$.
Therefore, we are just left to show $\varphi(r) \in \Gamma(p) \implies r \in \gamma(p)$.

Consider $r \in \R'$ so that $\varphi(r) \in \Gamma(p)$.
If $r \not \in \gamma(p)$, we contradict $\varphi(\gamma(p)) \in \Gamma(p)$, so $r$ must be in $\gamma(p)$.

Thus, $\trim(\Gamma)$ finite $\implies \Gamma$ embeds $\gamma = \trim(\Gamma)$.
\jessie{End proof using Raf's definition of embedding}

\jessie{Begin J-embedding}
By Conjecture~\ref{conj:gam-prime-exists}, there is a nondegenerate, nonredundant $\gamma \preceq \Gamma$, and we trivially know that $\gamma \approx \gamma$, so we conclude the property $\gamma$ constructed in Conjecture~\ref{conj:gam-prime-exists} is embedded by $\Gamma$.
\jessie{End J-embedding}

%If $r \not \in \R$, there is some $r' \in \R$ so that $\Gamma_r \subseteq \Gamma_{r'}$, and we show $p \in \Gamma_r \implies p \in \Gamma_{r'} \implies p \in \gamma_{\bar \varphi^{-1}(r')}$.


%For any $r \in \R$, consider the level set $\Gamma_r$, if $\Gamma_r \in \trim(\Gamma)$, then there is a corresponding $\gamma_{r'}$ so that $p \in \Gamma_r \implies p \in \gamma_{r'}$ as $\strip(\gamma) = \trim(\Gamma)$.
%
%Now, if for some $r \in \R$, we observe $\Gamma_r \not \in \trim(\Gamma)$, we know $\Gamma_r$ is not full dimensional by Conjecture~\ref{conj:trim-full-dim}.
%As level sets of elicitable properties are closed (Lemma~\ref{lem:closed-level-sets}), there is some other $\tilde r \in \R$ so that $\Gamma_{\tilde r} \in \trim(\Gamma)$ and $p \in \Gamma_r \implies p \in \Gamma_{\tilde r} \implies p \in \gamma_{r'}$ for some $r' \in \R'$ so that $\tilde r = \varphi(r')$.


\item [$1 \implies 6$]
Since there is a nondegenerate, nonredundant property $\zeta \preceq \Gamma$ and $\strip(\zeta) = \trim(\Gamma)$ by the definition of J-embedding and $\zeta$ is finite, we know $\trim(\Gamma)$ is finite.
Additionally, we know that $L|_{\R'}$ elicits $\trim(\Gamma)$ from \emph{cvx-fin-notes.tex}.

\item [$6 \implies 2$]
Since $\Gamma$ is nondegenerate and every $\theta \in \trim(\Gamma)$ is full dimensional (Conjecture~\ref{conj:trim-full-dim}), it is clear that the union of the (full-dimensional) level sets of $\trim(\Gamma)$ union to $\P$.

%\item [$2 \implies 3$]
%We know that (a.) is satisfied by assumption.
%Since $\Gamma$ is elicitable, the convex score $G(p)$ corresponds to the optimal report set at a distribution $p$.
%Since $G$ is convex, it is differentiable almost everywhere, so the optimal report is unique almost everywhere. \jessie{Can't say this unless $\Gamma$ is nonredundant.}
%In the interior of a convex level set has positive measure, the optimal report on the interior of each level set must then be unique.

\item [$2 \implies 4$]
	We know there is a nonredundant, nondegenerate proeprty $\gamma : \P \toto \R$ so that $\gamma \preceq \Gamma$ and therefore $\strip(\gamma) = \trim(\Gamma) = \Theta$ by Conjecture~\ref{conj:gam-prime-exists} and the definition of trim.
	We then want to show $\strip(\Gamma) = \strip(\gamma) \bigcup S$, where $S$ is some finite set.
	Consider the level set $\Gamma_{r'}$ for $r' = \varphi(r) \in \reals^d$.
	If $r' \in \R$, then $\Gamma_{r'} \in \strip(\gamma)$.
	If $r' \not \in \R$, then there is a report $r \in \R$ so that the level set $\Gamma_{r'} \subseteq \gamma_r$ has empty interior by Conjecture~\ref{conj:lev-sets-subsets}.
			
	We know this only happens at lower dimensional level sets $\theta$ since the optimal report is unique on the interior of level sets as $\gamma$ is nonredundant.
	Since $\theta$ is not full dimensional and there is only a finite set of full dimensional level sets at union to $\P$, we know there is a finite set of full dimensional level sets $\{\theta_i\}_{i=1}^m$ in the $\epsilon$-ball around each $p \in \theta$ so that for any $p_i \in \inter{\theta_i}$, we observe $\partial G(p_i) \neq \partial G(p_j)$ for all $i \neq j$ and $\partial G(p_i) = \gamma(p_i) = \{r_i\}$ for all $1 \leq i \leq m$.
	Additionally, as level sets are closed, we claim $p \in \gamma_{r_i} \implies p \in \Gamma_{\varphi(r_i)}$ for all $1 \leq i \leq m$.
	Therefore, $p \in \theta \implies p \in \bigcap_{r' \in \{r_i\}_{i=1}^m} \gamma_{r'}\implies p \in \bigcap_{r' \in \{r_i\}_{i=1}^m} \Gamma_{\varphi(r')}$ by closure of level sets for some $\{r_i\}_{i=1}^m \subseteq \R'$.
	As $\R'$ is finite, so is the power set $2^{\R'}$, so the set $S = \{\Gamma_r : r \in \reals^d \setminus \R \}$ is finite.
	Therefore $\strip(\Gamma) = \strip(\gamma) \bigcup S$ is finite. 
		

\item [$4 \implies 5$]
Since $\trim(\Gamma) \subseteq \strip(\Gamma)$, then the strip being finite implies the trim is finite.


%\item[$2 \implies 1$]  
%\emph{Assumptions used: Nondegeneracy, elicitability of $\Gamma$}
%
%Let $\Theta := \trim(\Gamma)$ be a finite set.
%By Conjecture~\ref{conj:gam-prime-exists}, there is then a nonredundant, nondegenerate property $\Gamma'$ such that $\strip(\Gamma') = \trim(\Gamma)$.
%Let $\R' \subseteq \R$ be the finite set used to define the property $\Gamma'$.
%
%As $\Theta$ is finite and $\trim(\Gamma)$ is the set of full dimensional level sets of $\Gamma$, the finite number of full-dimensional level sets follows from the assumption and definitions combined.
%
%Consider a level set $\theta\in \Theta$.
%There is a report $r \in \R'$ so that $\Gamma'(p) = \{r\}$ for all $p \in \inter{\theta}$; this follows from nonredundancy of $\Gamma'$.
%
%Therefore if the function $\trim(\Gamma)$ is well-defined and finite, then the labeled property $\Gamma$ has a finite set of full-dimensional level sets and for every $\theta \in \Theta$, there is a unique optimal report for every distribution $p \in \inter{\theta}$.
%\jessie{Uniqueness actually follows from concavity of Bayes Risk, since the measure of the sets with multiple viable labels has to be of measure zero, and can't be full dimensional.}
%
%
%%Let $\Theta := \trim(\Gamma)$ be a finite set.
%%By construction, $\Theta$ is a set of full dimensional level sets defining the property $\Gamma$.
%%Thus, $\Gamma$ then only has finitely many \emph{full-dimensional} level sets.
%%Then there is a finite set $\R' \subseteq \R$ defined by the property $\Gamma' \preceq \Gamma$ where $\strip(\Gamma') = \trim(\Gamma)$.\jessie{Make sure I can claim this.}
%%
%%Consider a level set $\theta \in \Theta$.
%%We want to show there is a unique $r \in \R'$ such that $\Gamma(p) = \{r\}$ for all $p \in \inter{\theta}$.
%%
%%Take the finite set $\R' \subseteq \R$ such that the nondegenerate, nonredundant property $\Gamma' \preceq \Gamma$.
%%Fix some level set $\theta \in \Theta$.
%%For any $p \in \inter{\theta}$, there is then a report $r \in \R'$ such that  $r \in \Gamma(p)$ by nondegeneracy of $\Gamma'$.
%%We then want to show $r$ is unique.
%%
%%For contradiction, consider some $r' \in \R'$ such that $r \neq r'$.
%%As $\trim(\Gamma) = \strip(\Gamma')$ contains only full dimensional level sets, then $\Gamma_r$ and $\Gamma_{r'}$ are both full dimensional, as is their intersection $\Gamma_r \cap \Gamma_{r'}$.
%%Since we define $\Gamma'$ in a manner so that for all $r \in \R' \implies \Gamma_r = \Gamma'_r$, we then say $\Gamma_r \cap \Gamma_{r'} = \Gamma'_r \cap \Gamma'_{r'}$, which contradicts the nonredundancy of $\Gamma'$.
%%Therefore we observe a contradiction, and conclude $r = r'$.
%%Therefore, if $\trim(\Gamma)$ is finite, then the property $\Gamma$ has a finite set (namely, $\trim(\Gamma)$) of full dimensional level sets so that for every $\theta \in \Theta$, there is a unique optimal report $r$ for every $p \in \inter{\theta}$.
\end{enumerate} 

\end{proof}

%\section{To Do after meeting 9.24.18}
%
%
%\begin{enumerate}
%\item[a.] look at Rockefellar- algebraic interior
%
%\item[b.] Appendix of complexity paper- the Bayes Risk must be strictly concave.
%\end{enumerate}



\section{Lemmas that probably aren't necessary to show in a paper, but for the sake of convincing myself}

\begin{lemma}\label{lem:closed-level-sets}
	Let $\Gamma$ be elicitable.
	For any $r\in\R$, the level set $\Gamma_r = \{ p \in \Delta(\Y) : \Gamma(p) = r \}$ is closed.
\end{lemma}
\begin{proof}[Proof sketch]
	Let $L$ elicit $\Gamma$.
	The function $G(p) = -\min_{r\in\R} \E_p L(r,Y) = -\E_p L(\Gamma(p),Y)$ (taking any $r\in\Gamma(p)$ in case of ties) is convex.
	There exists $\D \subseteq \partial G$ and some bijection $\varphi : \R \to \D$ with $\Gamma(p) = \varphi^{-1}(\D\cap \partial G_p)$.
	Thus, $\Gamma_r = \{p : r\in\Gamma(p)\} = \{p : \varphi(r) \in \D\cap\partial G_p\} = \{p : \varphi(r) \in \partial G_p\}$, which is closed by convex analysis.
	See [Raf/Ian\footnote{\url{https://arxiv.org/pdf/1211.3043.pdf}} (Cor 3.11), with their Thm 3.5 and Rockefellar Thm 24.4]  
\end{proof}


\begin{definition}\label{def:unlabeled-nonredundant}
	An unlabeled property $\Theta$ is \emph{nonredundant} if for there are no full dimensional level sets $\theta_1, \theta_2 \in \Theta$ so that $\theta_1 \subseteq \theta_2$.
	%  \raft{Have not defined elicitability for unlabeled properties.  Also, what does ``almost everywhere'' mean in this context, since $\Theta$ is just a set of sets?  I think we just want to say that there are no distinct $\theta_1,\theta_2 \in \Theta$ such that $\theta_1 \subseteq \theta_2$.  JF: you're right... shoot}
	\jessie{Equivalent to definition of nonredundancy for labeled property $\Gamma$, shown in Lemma~\ref{lem:nonredundant-defs-equivalent}.}
\end{definition}

\begin{lemma}\label{lem:nonredundant-defs-equivalent}
	An elicitable property $\Gamma$ with finite level sets is nonredundant (in the labeled definition) $\iff$ $\strip(\Gamma)$ is nonredundant (in the unlabeled definition.)
\end{lemma}
\begin{proof}
	If the property $\Gamma$ is nonredundant, there is a bijection $\varphi:\R \toto \P$ so that $\varphi(r) = \Gamma_r$ and $\varphi^{-1}(\theta_i) = r_i$ for each level set $\theta_i \in \Theta = \strip(\Gamma)$.
	Therefore, if there are no $r_i, r_j$ so that $\Gamma_{r_i} \subseteq \Gamma_{r_j}$ then there are no level sets $\theta_i = \varphi(r_i), \theta_j = \varphi(r_j)$ so that $\theta_i \subseteq \theta_j$.
	
	Similarly, if there is no $\theta_i \subseteq \theta_j$, then there are labels for each $i$ so that $r_i = \varphi^{-1}(\theta_i)$ and there is no distinct $i,j$ so that $\Gamma_{r_i} \subseteq \Gamma_{r_j}$ 	
	\jessie{This proof doesn't really need to be in here, but it's already typed up, so...}
	
%	We show both directions.\\
%	\begin{enumerate}
%		\item [$\implies$]
%		Let the property $\Gamma:\P \to \R$ be nonredundant.
%		Then for any two reports $r, r' \in \R$ with $r \neq r'$, the level sets $\theta := \Gamma_r \not \subseteq \Gamma_{r'}$ and $\theta' := \Gamma_{r'} \not \subseteq \Gamma_r$.
%
%		For each $r_i \in \R$ we know that there is a level set $\theta_i$ corresponding to the labeled level set $\Gamma_{r_i}$.
%		As there is no level set $\theta$ that does not correspond to some $r \in \R$ by nondegeneracy of $\Gamma$ and no $\Gamma_{r_i} \subseteq \Gamma_{r_j}$ for $i \neq j$, then there are no corresponding level sets so that $\theta_i \subseteq \theta_j$.
%		
%		
%		\item[$\impliedby$] 
%		Say that for there are no distinct full dimensional level sets $\theta, \theta' \in \Theta := \strip(\Gamma)$ that $\theta \subseteq \theta'$.
%		Then there are reports $r, r' \in \R$ such that $\theta = \Gamma_r$ and $\theta' = \Gamma_{r'}$.
%		
%		\jessie{Come back later if needed}
%
%		Therefore, $\strip(\Gamma)$ is nonredundant $\implies \Gamma$ is nonredundant.
%	\end{enumerate}
	
\end{proof}

\begin{lemma}\label{lem:pos-measure-iff-nonempty-int}
Let $S$ be a convex set.
$S$ has nonempty interior $\implies$ has positive Lebesgue measure.
\end{lemma}
\begin{proof}

%%%\begin{enumerate}
%%%	\item[$\implies$]
	Let $S$ have nonempty interior.
	We know that as $\inter{S}$ and $bd(S)$ are disjoint, $\mu(S) = \mu(\inter{S}) + \mu(bd(S))$.
	Since the interior of $S$ is nonempty, there is an open ball $B \subseteq S$ such that $x \in B \implies x \in \inter S$.
	As Lebesgue measure in $\reals^n$ is a product measure and every open interval has positive measure, then the Lebesgue measure of the ball $B$ is the product of finitely many positive measures, and therefore positive.
	As $0 < \mu(B) \leq \mu(\inter S) \leq \mu(S)$ by monotonicity, we see that $S$ with nonempty interior has positive measure.
	
%%%	\item[$\impliedby$]  		
%%%	Follows from the contrapositive and definition of measure.
%%%%		That is, $\mu(S) = \mu(\inter{S}) + \mu(bd(S)) = \mu(\inter{S})$.\footnote{Since $S$ is convex, $\mu(bd(S)) = 0$ according to \url{https://math.stackexchange.com/questions/613408/when-does-the-boundary-have-measure-zero}.}
%%%%		As $\inter{S} = \emptyset \implies \mu(\inter{S}) = 0$, and hence does not have positive measure.
	
%%%		\jessie{Use Lemma~\ref{lem:nonempty-inter-iff-aff-ind}.}
%%%	\end{enumerate}
\end{proof}

\begin{lemma}\label{lem:nonempty-inter-iff-aff-ind}
	Let $\theta$ be a [closed] convex level set.
	$\theta$ is full dimensional $\iff$ there are distributions $p_1, p_2, \ldots, p_n \in \theta$ so that $p_1, p_2, \ldots, p_n$ are affinely independent.
\end{lemma}
\begin{proof}
	Recall that $n := |\Delta(\Y)|$, so we say the simplex is $n$-dimensional.
	\begin{enumerate}
		\item [$\implies$]
		Assume the level set $\theta$ is full dimensional.
		Then there exists a $p \in \inter{\theta}$ and for every $q \in B(\epsilon, p)$, we know that $q \in \theta$.
		Take $q_i = p + \epsilon e_i$\footnote{$e_i$ is the vector with $1$ in the $i^{th}$ component, and is $0$ elsewhere} in each of the $n$ dimensions, and since $\theta$ is full dimensional and closed, we know each $q_i \in\theta$.
		As $\{e_i\}_{i=1}^n$ is affinely independent (it forms the standard basis for $\reals^n$), so then is $\{q_i\}_{i=1}^n$ as we are invariant to additive and multiplicative shifts.		
		
		\item [$\impliedby$]
		Let the set of distributions $Q := \{q_i\}_{i=1}^n$ be affinely independent, where each $q_i \in \theta$.
		Since the set $\theta$ is convex, then the convex hull $\conv(Q) \subseteq \theta$.
		It is sufficient to show $\conv(Q)$ is full dimensional.
		Let $q_1, q_2 \in Q$ so that $q_1 \neq q_2$.
		As $p = \sum_{i=1}^n \frac{1}{n}q_i \in \conv(Q)$, as is every $q \in B(\epsilon, p)$ since they are also convex combinations of elements of $Q$, we can see $\emptyset \neq \inter{\conv(Q)} \subseteq \inter{\theta}$, so we conclude $\theta$ is full-dimensional.
	\end{enumerate}
\end{proof}



%%% COMMETNED OUT 10/24/18
%%%To show $\gamma \preceq \Gamma$, we know that since $\Gamma$ embeds $\gamma$, there is an injection $\varphi : \R' \to \reals^d$ so that $r' \in \gamma(p) \iff \varphi(r') \in \Gamma(p)$.
%%%Therefore, we know for all $r' \in \R'$ that $\varphi(r') \in \R$, therefore, $\varphi(\R') \subseteq \R$.
%%%As $\varphi(\R') \subseteq \R$ and $\gamma$ is nondegenerate, we know that for all $p \in \P$, we know $\gamma(p) = \Gamma(p) \cap \varphi(\R')$.
%%%Therefore, $\gamma \preceq \Gamma$.
%%%
%%%Finally we know $\gamma$ is nonredundant since $\varphi$ is an injection.
%%%Thus, $\gamma_r \subseteq \gamma_{r'}$ for $r, r' \in \R'$ and $r \neq r$ implies that $\Gamma_{\varphi(r)} \subseteq \Gamma_{\varphi(r')}$.
%%%Since $\varphi$ is an injection, we know that $\varphi(r) \neq \varphi(r')$.
%%%Since $\gamma$ is finite and nondegenerate, at any distribution $p$, there are $1 \leq m \leq |\R'|$ reports in $\gamma(p)$.
%%%
%%%For contradiction, suppose there are two reports $r, r' \in \R'$ so that $r \neq r'$ and $\gamma_r \subseteq \gamma_{r'}$.
%%%Since $\Gamma$ embeds $\gamma$, for any $p \in \P$, we know $p \in \gamma_r \iff p \in \Gamma_{\varphi(r)}$.
%%%Therefore, $\Gamma_{\varphi(r)} \subseteq \Gamma_{\varphi(r')}$, where $\varphi(r) \neq \varphi(r')$ as $\varphi$ is an injection.
%%%	
%%%Since $\gamma_r \subseteq \gamma_{r'}$, then $\gamma_r \cap \gamma_{r'} = \gamma_r$.
%%%We know $p \in \gamma_r$ and $\gamma_{r'} \iff p \in \Gamma_{\varphi(r)}$ and $\Gamma_{\varphi(r')} \iff p \in \Gamma_{\lambda \varphi(r) + (1-\lambda) \varphi(r')}$ for all $\lambda \in [0,1]$ by elicitability of $\Gamma$ and closure of subgradient sets of $G_{\Gamma}$.
%%%Since the reals are (uncountably) infinite, we then contradict the finiteness of $\gamma$.
%%%Therefore, we conclude $\gamma$ must be nonredundant.
%%%\jessie{This gets at the idea, but I don't think it's correct.  It also might rely on convexity of $\R$, or we should generalize to $\reals^d$.}
%%%
%%%
%%%Since $\gamma \preceq \Gamma$ and $\gamma$ is nondegenerate and nonredundant, we apply Lemma~\ref{lem:define-trim} to observe $\trim(\Gamma) = \strip(\gamma)$.
%%%END COMMETNED OUT 10/24/18
%\end{proof}


\end{document}
%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:

