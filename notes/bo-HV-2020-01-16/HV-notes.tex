\documentclass[12pt]{article}
\usepackage{amsmath,amsfonts,amssymb,amsthm}

\newcommand{\R}{\mathcal{R}}
\newcommand{\Y}{\mathcal{Y}}

\newcommand{\reals}{\mathbb{R}}
\newcommand{\nonnegreals}{{\reals_{\geq 0}}}


\begin{document}
We have a discrete loss on a finite set, $\ell: \R \times \Y \to \nonnegreals$ eliciting $\gamma: \Delta_{\Y} \to 2^{\R}$.

%Suppose we have an embedding $L: \reals^d \times \Y \to \nonnegreals$ eliciting $\Gamma: \Delta_{\Y} \to 2^{\reals}$ with embedding points $\{ u_r : r \in \R\}$, i.e. for all $r$, $\gamma_r = \Gamma_{u_r}$.

\vskip1em
Because $\R$ is finite, $\gamma_r$ is a polytope inside the probability simplex with a minimal halfspace representation, let us say $\{p : B^rp \geq 0\}$ for a matrix $B^r \in \reals^{k_r \times |\Y|\}$, for some integer $k_r$.
We can take the inequalities to be of this form because the simplex includes the constraint $\sum_{y \in \Y} p_y = 1$, hance any inequality $bp \geq c$ can be converted to the form $b'p \geq 0$ with $b'_y = b_y - c$.

Meanwhile, $\gamma_r$ also has a minimal vertex representation, let us say a collection $Q_r = \{q^r_1, \dots, q^r_{K_r}\}$ for some integer $K_r$.

\vskip1em
Now suppose we have a polyhedral loss $L: \reals^d \times \Y \to \nonnegreals$ eliciting $\Gamma: \Delta_{\Y} \to 2^{\reals^d}$.
Write $L_y(u) = L(u,y)$ and let the subdifferential of this function be $T^u_y = \partial L_y(u)$.

\vskip1em
\textbf{Definition.} $L$ \emph{embeds} $\ell$ with embedding points $\{u_r : r \in \R\}$ if, for all $r$, $\gamma_r = \Gamma_{u_r}$.

\textbf{Claim.} $L$ embeds $\ell$ if and only if, for all $r$ and $p$, $p \in \gamma_r$ if and only if $0 \in \oplus_{y \in \Y} p_y T^{u_r}_y$ where the right side is a Minkowski sum of sets scaled by the $p_y$s.

\vskip1em
\textbf{Main claim:} $L$ embeds $\ell$ with embedding points $\{u_r : r\ in \R\}$ if and only if both of the following hold:

(1: if a halfspace boundary of $\gamma_r$ is violated, $u_r$ is not optimal.).

(2: for all corner vertices of $\gamma_r$, $u_r$ is optimal.)

\vskip1em
\emph{Proof:}
Let $p \in \Gamma_{u_r}$.
Then $0 \in \oplus_{y \in \Y} p_y T^{u_r}_y$, so there exist $\{w_y\}$...
...
...
So $\Gamma_{u_r} \subseteq \gamma_r$.

Suppose for all $r$, for each vertex $q \in Q_r$, there exist $\{w_y \in T^{u_r}_y : y \in \Y\}$ with $0 = \oplus_{y \in \Y} q_y w_y$.
This implies $u_r$ minimizes $\langle q, L(u) \rangle$.
By convexity, $u_r$ minimizes $\langle q', L(u)\rangle$ for any mixture $q'$ in the convex hull of $Q_r$.
So $\gamma_r \subseteq \Gamma_{u_r}$



\vskip4em
Reminder: We have $0 \in \oplus_y p_y T_y^{u_r}$ if and only if, for all $v$, $0 \leq \max_{w^y : y \in \Y} v \cdot \sum_y p_y w^y$, where each $w^y$ is chosen from $T_y^{u_r}$; and this holds if and only if, for all $v$,
  \[ 0 \leq \sum_y p_y \left(\max_{w \in T_y^{u_r}} v \cdot w\right). \]
Meanwhile, the condition $Bp \geq 0$ implies, for each row $i$ of $B$, we have
  \[ 0 \leq \sum_y p_y B_{iy} . \]
So ... what?



\end{document}
